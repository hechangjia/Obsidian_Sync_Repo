---
tags:
  - math
  - 实分析
  - 概率论
---

> [!问题]
> 求下面含参数积分的极限:$$\lim_{n\to \infty} \int_{[0,1]^n}n\left(\frac{\sum_{i\leq n} x_i^2}{\sum_{i\leq n} x_i}-\frac{2}{3}\right)\,dx_{1}\cdots dx_n$$

此问题是对基于[[用概率计算含参数积分的极限]]当中例子3的其中一个特例进行了进一步的讨论。在这篇笔记的例子3当中我们知道:
$$I_n:=\int_{[0,1]^n}\frac{\sum_{i\leq n} x_i^2}{\sum_{i\leq n} x_i}\,dx_{1}\cdots dx_n\to \frac{2}{3}$$
现在相当于我们需要给出$I_n$更为精确的渐近展开，也就是说至少要得到$$I_n=\frac{2}{3}+\frac{a}{n}+o\left(\frac{1}{n}\right)$$这样的渐近结果才行，并且确定渐近系数$a$.

首先我们还是按照[[用概率计算含参数积分的极限]]当中的思路，我们把问题转换为概率版本的问题：

> [!概率版本的等价问题]
> 在概率空间$(\Omega,\mathcal{F},P)$上有一列独立且符合$U(0,1)$的随机变量$X_1,...,X_n,...$,求期望的极限:
>$$E \left [n\left(\frac{\overline{Y_n}}{\overline{X_n}}-\frac{2}{3}\right)\right]$$其中$\overline{Y_n} = \frac{\sum_{i\leq n} X_i^2}{n}$，以及$\overline{X_n} = \frac{\sum_{i\leq n} X_i}{n}$

观察中间的随机变量，$$\frac{\overline{Y_n}(\omega)}{\overline{X_n}(\omega)}-\frac{1/3}{1/2}$$
其中由弱大数定律我们知道，$\overline{Y_n}(\omega)\xrightarrow{P}{1/3},\overline{X_n}(\omega)\xrightarrow{P}{1/2}$,这不禁让我们想到:

> [!想法]
> 如果我们可以把函数$f(x,y)=\frac{y}{x}$在取值靠近0的点$(1/2,1/3)$处展开的话，内部的期望会更容易算一些。

于是由Taylor展开定理：
$$f(x,y)=
\frac{2}{3} - \frac{4}{3}\left(x - \frac{1}{2}\right) + 2\left(y - \frac{1}{3}\right) + \frac{8}{3}\left(x - \frac{1}{2}\right)^2 - 4\left(x - \frac{1}{2}\right)\left(y - \frac{1}{3}\right)
+o\left[\left(x - \frac{1}{2}\right)^2 +\left(y - \frac{1}{3}\right)^2 \right]$$

那么带入$\overline{Y_n}(\omega),\overline{X_n}(\omega)$然后我们注意一些关于期望，方差，协方差的基本定义和运算:

>[!关于期望，方差，协方差的基本定义和运算]
>如果$X_1,...,X_n$以及$Y_1,...,Y_n$是概率空间当中两列独立同分布的随机变量，并且定义$\overline{Y_n} = \frac{\sum_{i\leq n} Y_i}{n}$，以及$\overline{X_n} = \frac{\sum_{i\leq n} X_i}{n}$，那么: 
> 1. $$E(\overline{X_n}-E(X_1))=0$$
> 2. 
> $$E\left[\left(\overline{X_n}-E(X_1)\right)^2\right]=\frac{V(X_1)}{n}$$
> 3. 
> $$\begin{aligned}E\left[\left(\overline{X_n}-E(X_1)\right)\left(\overline{Y_n}-E(Y_1)\right)\right]&=\text{Cov}(\overline{X_n},\overline{Y_n})\\&=E(\overline{X_n}\,\overline{Y_n})-E(\overline{X_n})E(\overline{Y_n})\end{aligned}$$

利用上述结论，并且带入该问题的随机变量(其中$\overline{Y_n} = \frac{\sum_{i\leq n} X_i^2}{n},X_i\sim U(0,1)$)，我们可以得到:
1. $$E(\overline{X_n}-1/2)=0,E(\overline{Y_n}-1/3)=0$$
2. $$E\left[\left(\overline{X_n}-1/2\right)^2\right]=\frac{1}{12n},E\left[\left(\overline{Y_n}-1/3\right)^2\right]=\frac{4}{45n}$$
3. $$\begin{aligned}E\left[\left(\overline{X_n}-1/2\right)\left(\overline{Y_n}-1/3\right)\right]&=\text{Cov}(\overline{X_n},\overline{Y_n})\\&=E(\overline{X_n}\,\overline{Y_n})-E(\overline{X_n})E(\overline{Y_n})\\&= \frac{1}{12n}\end{aligned}$$
接下来只需要带入以上结果就可以得到渐近展开,令$R(x,y)$为函数$y/x$的Taylor展开的余项，同时令$R_n=E\left[R\left(\overline{X_n}(\omega),\overline{Y_n}(\omega)\right)\right]$那么如果我们用Taylor展开来估计本问题当中的需要计算的期望，那么:
$$\begin{aligned}E \left [n\left(\frac{\overline{Y_n}}{\overline{X_n}}-\frac{2}{3}\right)\right]&=\frac{8}{3}E\left[n\left(\overline{X_n}-\frac{1}{2}\right)^2\right]-4E\left[n\left(\overline{X_n}-\frac{1}{2}\right)\left(\overline{Y_n}-\frac{1}{3}\right)\right] \\ &+ nR_n\\ &= \frac{8}{3}\cdot \frac{1}{12}-4\cdot\frac{1}{12}+nR_n \\ &= -\frac{1}{9}+nR_n \end{aligned}$$

不过这里注意因为函数$y/x$的Taylor展开的Peano余项$$R(x,y)=o\left[\left(x - \frac{1}{2}\right)^2 +\left(y - \frac{1}{3}\right)^2 \right]$$说的是，$\forall \varepsilon >0$存在$\delta>0$使得当$\sqrt{(x-1/2)^2+(y-1/3)^2}<\delta$的时候有
$$|R(x,y)|\leq \varepsilon \left[(x-1/2)^2+(y-1/3)^2\right]$$
可是$\left(\overline{X_n}(\omega),\overline{Y_n}(\omega)\right)\in (0,1)^2$,未必就在开圆盘$D_{\delta}(A)$内部(令$A=(1/2,1/3)$）。也就是说我们没有办法直接得到$R_n=o\left(\frac{1}{n}\right)$的结论。

不过没有关系，因为弱大数定律告诉我们，二者的值随着$n$的变化几乎都集中在圆心$A$附近，下面我们利用这个性质来估计$R_n$。

> [!lemma1]
> $\lim_{n\to \infty}nR_n=0$,即$$R_n=o\left(\frac{1}{n}\right)$$

为了证明这个lemma，我们的策略是把样本空间$\Omega$分为两个部分,$\Omega=S_n\cup \Omega\setminus S_n$,其中$$\begin{aligned}S_n&:=\left\{\omega\in \Omega:\left(\overline{X_n}(\omega),\overline{Y_n}(\omega)\right)\in D_{\delta}(A)\right\}\\&=\left\{\omega\in \Omega:\left(\overline{X_n}(\omega)-1/2\right)^2+\left(\overline{Y_n}(\omega)-1/3\right)^2<\delta^2\right\}\end{aligned}$$
这样划分以后$$R_n=\int_{S_n} R(\overline{X}_n,\overline{Y}_n)\,dP+\int_{\Omega\setminus S_n}R(\overline{X}_n,\overline{Y}_n)\,dP$$
* **$\Omega\setminus S_n$上的情况**：
首先从定义上很容易看到$\overline{Y}_n\leq \overline{X}_n$,因此实际上$y/x$是有界函数，那么余项$R(x,y)$作为该函数减去一个多项式以后的结果，也是有界的。另一方面，由Chebyshev不等式(以及“函数的分布函数”的不等式性质，参考[[an epsilon of room证明集合为0测度的策略]]当中0.1,0.2两节中关于函数的分布函数的性质。此处的“分布函数”并非概率论中的分布)告诉我们:$$\begin{aligned}P(\Omega\setminus S_n)&\leq P((\overline{X}_n-1/2)^2\geq \delta^2/2)+P((\overline{Y}_n-1/3)^2\geq\delta^2/2) \\ &\leq \frac{V(X_1)}{n\delta^2/2}+\frac{V(Y_1)}{n\delta^2/2}=O\left(\frac{1}{n\delta^2}\right)\end{aligned}$$
不过这个结果还不够强力，因为毕竟我们要证明$\lim_{n\to \infty}nR_n=0$，上面的结果只能够让我们知道这部分乘上n是有界的，而不能得到我们想要的结果。不过我们知道，弱大数定律的定量版本的证明无外乎就是Chebyshev不等式，而上述不等式无非就是利用随机变量的$L^1$范数来控制测度的上界，如果我们尝试$L^p$范数来控制上界，结果会不会更好呢？(Chebyshev不等式说的是$P(|X|\geq a)\leq \frac{E(|X|^p)}{a^p}$)

1. **执行$L^p$范数的控制**:
可是$E\left[(\overline{X}_n-1/2)^{2p}\right]$真的好难算，所以留给读者。

不过这里我们不是真的要得到任意$p$的估计，利用Marcinkiewicz-Zygmund不等式可以做到的估计是:$$E\left[(\overline{X}_n-1/2)^r\right]\ll_r \frac{1}{n^{r/2}}$$所以**好消息是，只需要算$p=2$的情况，也就是利用$(\overline{X}_n-1/2)^{2}$的$L^2$范数估计就行了。**


2. **为什么不试试Hoeffding不等式的结果呢？**

因为这里随机变量，不管是$X_i$或者是$X_i^2$都是介于$0,1$之间的随机变量，提到弱大数定律的定量形式，针对这种有界随机变量就不得不提到Hoeffding不等式:

> [!Hoeffding不等式]
> 假设概率空间$(\Omega,\mathcal{F},P)$上的随机变量$X_n$是独立同分布的，并且$X_n(\omega)\in [a,b]$对任意正整数n成立，$\overline{X}_n$是前n个随机变量的算数平均值，$\mu$是这列随机变量的均值，那么对于任意$\varepsilon>0$都有:$$P\left(|\overline{X}_n-\mu|\geq \varepsilon \right)\leq 2\exp\left(-\frac{2n\varepsilon^2}{(b-a)^2}\right)$$

直接利用这个不等式我们能轻易得到:
$$\begin{aligned}P(\Omega\setminus S_n)&\leq P((\overline{X}_n-1/2)^2\geq \delta^2/2)+P((\overline{Y}_n-1/3)^2\geq\delta^2/2) \\ & \leq 4\exp(-n\delta^2)\end{aligned}$$

于是$$\int_{\Omega\setminus S_n}R(\overline{X}_n,\overline{Y}_n)\,dP=O\left(\exp(-n\delta^2)\right)$$
* **$S_n$上的情况**:
在$S_n$上，Taylor定理告诉我们$$|R(x,y)|\leq \varepsilon \left[(x-1/2)^2+(y-1/3)^2\right]$$
于是此时$$\begin{aligned}\int_{S_n} R(\overline{X}_n,\overline{Y}_n)\,dP &\leq \varepsilon \int_{S_n}\left[(\overline{X}_n-1/2)^2+(\overline{Y}_n-1/3)^2\right]\\ &\leq \varepsilon E\left[(\overline{X}_n-1/2)^2+(\overline{Y}_n-1/3)^2\right]\\&= \varepsilon O\left( \frac{1}{n}\right)\end{aligned}$$
于是综上所述$$\limsup_{n\to \infty}nR_n\leq \varepsilon $$对任意正实数$\varepsilon$成立.

于是我们知道，$$E \left [n\left(\frac{\overline{Y_n}}{\overline{X_n}}-\frac{2}{3}\right)\right]\to -\frac{1}{9}$$那么原来的问题的结果就是:$$I_n=\frac{2}{3}-\frac{1}{9n}+o\left(\frac{1}{n}\right)$$

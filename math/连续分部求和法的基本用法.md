---
tags:
  - math
---
### 1. 问题1

> [!问题1]
> 估计求和$$S(x)=\sum_{n\leq x}n^{a}\log(n),a>0$$

这个问题其实两边都是可微的，而且很难说$n^a$或者说$\log(n)$的和谁会更加不错一些，所以我们不妨都试试看:

#### 1.1 如果我们认为$n^a$的和更为不错一些

那么令$$A(x)=\sum_{n\leq x}n^a=\frac{x^{a+1}}{a+1}+O(x^a)$$上面的过程无非就是使用Euler-Maclaurin的求和公式(参考[[和的积分估计]]的第二部分)。

然后我们使用分部求和，$$\begin{aligned}S(x)&=A(x)\log(x)-\int_1^{x}\frac{A(t)}{t}dt\\&=\frac{x^{a+1}}{a+1}\left(\log x-\frac{1}{a+1}\right)+O\left(x^a\log x\right)\end{aligned}$$
#### 1.2 如果我们认为$\log(n)$的和更为不错一些

那么令
$$B(x)=\sum_{n\leq x}\log(n)=x\log(x)-x+O(\log(x))$$于是使用分部求和公式得到:$$\begin{aligned}S(x)&=B(x)x^a-\int_1^{x}aB(t)t^{a-1}dt\\&=x^{a+1}\log(x)-x^{a+1}+O(x^a\log(x))-\int_{1}^{x}\left(at^{a}\log(t)-at^{a}+O(t^{a-1}\log(t))\right)dt\\&=\frac{x^{a+1}}{a+1}\left(\log x-\frac{1}{a+1}\right)+O\left(x^a\log x\right)\end{aligned}$$最后都得到了一样的结果，不过过程上来说，后者的计算要比前者稍微复杂一点。同时我们补充一点，因为$n^{a}\log(n)$本身也是光滑的，因此我们还可以通过Euler-Maclaurin求和来完成这件事，主要的问题集中在计算积分$\int_{1}^{x}t^a\log(t)dt$上，实际上这种途径反而比上面第二种分部求和要更容易一些。

所以有的时候选择那一部分作为部分和也是有讲究的，否则可能还没有直接处理来得更快。

### 2. 问题2

有时候使用分部求和是因为我们没得选:

> [!问题2]
> 假设我们只知道$g:\mathbb{N}\to\mathbb{C}$是一个算术函数，然后我们知道这个算术函数的"渐进平均值",即我们知道:$$\frac{1}{x}\sum_{n\leq x}g(n)\to A$$然后我们需要估计$$S(x):=\sum_{n\leq x}g(n)\log(n)$$

这个时候我们是没得选的，因为我们没有办法保证$g$是光滑的，但是我们知道$\log(n)$是光滑的。于是分部求和的时候，$$A(x)=\sum_{n\leq x}g(n)=Ax+o(x)$$然后启动分部求和的过程，$$\begin{aligned}S(x)=\sum_{n\leq x}g(n)\log(n)&=A(x)\log(x)-\int_1^{x}\frac{A(t)}{t}dt\\&=Ax\log(x)+o(x\log(x))-\int_{1}^{x}A+o(1)dt\\&=Ax\log(x)-Ax+o(x\log(x))\\&=Ax\log(x)+o(x\log(x))\end{aligned}$$
类似的例子还有：
### 3. 问题3

> [!问题3]
> $$S(x):=\sum_{2\leq n\leq x}\frac{1}{n\log(n)}$$要求余项做到$O\left(\frac{1}{x\log(x)}\right)$.

被求和对象中$1/n$的求和是不错的，那么令$$\begin{aligned}A(x):=\sum_{n\leq x}\frac{1}{n}&=\log(x)+\gamma+\int_{x}^{\infty}\frac{\{r\}}{r^2}\,dr\\&=\log(x)+\gamma+O(1/x)\end{aligned}$$
于 是$$\begin{aligned}S(x)&=C_1+\frac{\gamma}{\log(x)}+O\left(\frac{1}{x\log(x)}\right)+\int_{2}^{x}\frac{A(t)}{t\log^2(t)}\,dt \\ &= \log(\log(x))+C_2+\frac{\gamma}{\log(x)}+\int_{2}^{x}\frac{1}{t\log^2(t)}\,dt+ O\left(\frac{1}{x\log(x)}\right)\\&=\log(\log(x))+C_3+ O\left(\frac{1}{x\log(x)}\right)+\int_{2}^{\infty}\int_{t}^{\infty}\frac{\{r\}}{r^2t\log^2(t)}\,dr\,dt-\int_{x}^{\infty}\int_{t}^{\infty}\frac{\{r\}}{r^2t\log^2(t)}\,dr\,dt\\ &= \log(\log(x))+C_4+ O\left(\frac{1}{x\log(x)}\right)\end{aligned}$$
其中常数项其中$C_1,C_2,C_3,C_4$都是常数，其中$C_4\approx 0.795$。此外要注意，在余项带入$A(x)$地时候不要带入第一行有$O$的那种表达，因为这样的话会搞不清楚最后的常数项。

### 4. 问题4

> [!问题4]
> 估计和$$S(x):=\sum_{n\leq x}\frac{\log(n)}{n}$$要求余项做到$O\left(\frac{\log(x)}{x}\right)$.

首先尝试和问题3差不多的方法，令$$\begin{aligned}A(x):=\sum_{n\leq x}\frac{1}{n}&=\log(x)+\gamma+\int_{x}^{\infty}\frac{\{r\}}{r^2}\,dr\\&=\log(x)+\gamma+O(1/x)\end{aligned}$$
然后采用连续分部求和法:

$$\begin{aligned}S(x)&=\log(x)A(x)-\int_{1}^{x}\frac{A(t)}{t}\,dt\\&=\log^2(x)+\gamma\log(x)+O\left(\frac{\log(x)}{x}\right)-\int_{1}^{x}\frac{A(t)}{t}\,dt \\&= \frac{1}{2}\log^2(x)+O\left(\frac{\log(x)}{x}\right)-\int_{1}^{x}\int_{t}^{+\infty}\frac{\{r\}}{tr^2}\,dr\,dt \\&=...\end{aligned}$$

仔细看的话最后的积分余项依旧是发散的，即$\int_{x}^{+\infty}\int_{t}^{+\infty}\frac{\{r\}}{tr^2}\,dr\,dt$依旧是一个在$x\to+\infty$附近无界的函数，虽然**我们依旧是可以通过分部积分的方式让积分余项当中无穷的部分暴露出来，然后最后剩下常数的部分和无穷小的部分**。然而稍显麻烦，实际上我们一开始如果直接尝试用[[和的积分估计]]当中的Euler-Maclaurin法问题反而会更加简单一点。

$$\begin{aligned}S(x)&=\frac{1}{2}\log^2(x)+O\left(\frac{\log(x)}{x}\right)+\int_{1}^x\{t\}\left(\frac{1}{t^2}-\frac{\log(t)}{t^2}\right)\,dt\\&=\frac{1}{2}\log^2(x)+C+O\left(\frac{\log(x)}{x}\right) \end{aligned}$$

其中$C=\int_{1}^{+\infty}\frac{\{t\}}{t^2}\,dt-\int_{1}^{+\infty}\frac{\{t\}\log(t)}{t^2}\,dt\approx -0.073$

**所以这个例子告诉我们，如果不是遇到了问题2当中的情况，即求和对象有一部分根本不是光滑的(这在算数函数当中比较常见)，否则优先考虑Euler-Maclaurin求和估计反而更容易一些。**



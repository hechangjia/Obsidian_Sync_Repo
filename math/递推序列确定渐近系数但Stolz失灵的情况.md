---
tags:
  - math
  - 考研
  - 微积分
---

> [!问题1]
> $a_1=\frac{\pi}{2}$并且序列满足递推关系$$a_{n+1}=a_n-\frac{1}{n+1}\sin(a_n)$$证明序列$na_n$的极限存在。

### 1. Stolz-Cesaro定理失效了

面对这种，已经猜出极限存在性且已经知道$a_n$的渐近的主项，并且迭代的表达式中出现了差分的情况下，我们很难不回忆起之前的经验：
1. [[利用Stolz定理确定递归序列的渐近系数]]
2. [[利用Stolz定理确定递归序列的渐近系数2]]
此处虽然是证明极限存在性，不过如果我们可以搞清楚具体的渐近系数，或许其中的信息可以透露出序列$na_n$的一些行为。

但是稍加尝试很快就会感到失望，因为$$\frac{a_{n+1}-a_n}{\frac{1}{n+1}-\frac{1}{n}}=\frac{-\frac{1}{n+1}\sin(a_n)}{\frac{1}{n+1}-\frac{1}{n}}$$如果我们假设$a_n = \frac{a}{n}+o\left(\frac{a}{n}\right)$的话,上面式子的渐近展开实际上就是$a+o(1)$,那么这实际上和$\frac{a_n}{\frac{1}{n}}$是没有任何区别的，因此试图用此技巧制造关于待定系数$a$的方程是注定徒劳的。

### 2. 制造一个迭代的不等式

转念一想，我们只需要搞清楚其极限是否存在，而$na_n$的单调性实际上是很容易从迭代表达式中得到的。那么我们似乎只用证明$na_n$是有界的序列就行了。

第一节中Stolz之所以会失效是因为$\sin(x)$的渐近展开的第一项就是$x$，反过来我们倒是可以利用这一点。

对$\sin(a_n)$做渐近展开，我们知道$$\begin{aligned}a_{n+1}&=a_n -\frac{1}{n+1}\left(a_n -\frac{1}{6}a_n^3+o(a_n^3)\right)\\&= \frac{n}{n+1}a_n \left(1+\frac{1}{6n}a_n^2\right)+o\left(\frac{a_n^3}{n+1}\right)\end{aligned}$$此时我们想到，要是可以通过不等式把最后的尾巴(余项)去掉就好了，这样我们可以得到$a_{n+1},a_n$的迭代的不等式，就像[[用牛顿迭代法求算数平方根]]第三节的“误差分析”中的不等式那样，这样我们就可以通过迭代最终得到$a_n$的一个不等式。

那么如何甩掉最后的尾巴呢？自然是从把$\sin(x)$的渐近展开变成不等式开始。考虑$$\sin(x)\geq x-\frac{x^3}{6},x\geq 0$$于是我们得到$$a_{n+1}\leq \frac{n}{n+1}a_n \left(1+\frac{1}{6n}a_n^2\right)$$

### 3. 通过迭代得到有界的信息

> [!想法]
> 先用$a_n^2$的一个粗糙的上界放进迭代中，得到一个粗糙的估计。然后把这个粗糙的估计用来限制$a_n^2$从而制造一个新的迭代,然后执行新的迭代，直到我们得到$na_n$有界的信息。

* 一开始我们需要一个粗糙的估计，是因为我们真正想要的是$$a_{n+1}\leq a_nf(n)$$但是我们现在得到的确是$a_{n+1}\leq \frac{n}{n+1}a_n \left(1+\frac{1}{6n}a_n^2\right)$,因此我们首先需要一个上界来把括号里面的$a_n$给去除掉。

比如我们首先知道$a_n=o(1)$,那么可以用$a_n^2<3$这是对任意正整数成立的。于是第二节中最后得到的不等式变成了：$$a_{n+1}\leq \frac{n}{n+1}a_n \left(1+\frac{1}{2n}\right)$$于是通过迭代我们得到$$a_{n+1}\leq \frac{a_1}{n+1}\prod_{k=1}^{n}\left(1+\frac{1}{2k}\right)$$这里我们简单地对其中的乘积部分做一个估计:

> [!对乘积做估计]
> $P_n:=\prod_{k=1}^{n}\left(1+\frac{1}{2k}\right)$实际上我们只需要对$\log(P_n)$这个和做估计。$$\begin{aligned}\sum_{k\leq n}\log\left(1+\frac{1}{2k}\right)&\leq \frac{1}{2}\sum_{k\leq n}\frac{1}{k}\\&=\frac{1}{2}H_n\\&\leq \frac{1}{2}(\log(n)+1) \end{aligned}$$

于是$a_{n+1}$的上界可以估计为$$\begin{aligned}a_{n+1}&\leq \frac{C}{n+1}e^{\frac{1}{2}\log(n)}\\&\leq \frac{C}{\sqrt{n+1}}\end{aligned}$$其中$C = a_1 e^{1/2}$。

于是我们现在知道$a_{n}=O\left(n^{-1/2}\right)$。我们发现，通过迭代，我们把$a_n = O(1)$的估计变成了，$O\left(n^{-1/2}\right)$。

现在按照原计划，我们现在需要把这个结果重新带入到迭代的不等式中得到新的迭代：
$$a_{n+1}\leq \frac{a_1}{n+1}\prod_{k\leq n} \left(1+\frac{C^2}{6k^2}\right)$$而现在是时候停下来了，因为$\prod_{k=1}^{\infty} \left(1+\frac{C^2}{6k^2}\right)$是收敛的，因为$$\log\left(1+\frac{C^2}{6k^2}\right)=O\left(\frac{1}{k^2}\right)$$于是我们知道$na_n$是有界的，此外结合其单调性，我们知道它的极限是存在的。于是问题便解决了。

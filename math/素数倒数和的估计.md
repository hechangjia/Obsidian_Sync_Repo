---
tags:
  - math
  - 解析数论
---

> [!欧拉关于素数导数和的定理]
> $\mathbb{P}$是素数的集合，级数$$\sum_{p\in  \mathbb{P}} \frac{1}{p}$$发散。

这可以用来很粗略地描述素数作为自然数子集的"稀疏程度"，也可以用于表明素数是无穷多的，因为毕竟如果素数有限，那么以上求和无非就是一个有限求和，因此不可能是发散的。

不过我们这里不仅仅是定性地给出级数是否发散，还想要定量地描述，上述级数究竟发散得有多快？于是提出问题：

> [!以上问题的定量版本问题]
> 假设$p\in \mathbb{P}$,估计由级数定义出来的函数$$S(x):=\sum_{p\leq x} \frac{1}{p}$$

关于这个问题Mertens在1874年给出了一个解答：

> [!Mertens第二定理,1874]
> 存在一个常数$B$(现在称之为Mertens常数)使得$$\sum_{p\le x}\frac{1}{p}=\log\log(x)+B+O\left(\frac{1}{\log(x)}\right)$$

不过Mertens的结果还不足以强到直接导出素数定理，不过Mertens的结果依旧有着历史意义。

接下来我们先从欧拉的较弱一些的结论开始，然后慢慢强化到Mertens的结果。

### 1. 欧拉的结果

首先我们来证明欧拉的这个结果，即全体素数的倒数和是发散的。欧拉原始的证明是不严格的(甚至是有错误的，原因是因为那个年代分析学并不严格)。下面要展示的结果，融合了欧拉以及Erdos的想法。

首先此证明主要是受到了Euclid的影响，Euclid在历史上第一次证明了素数是无穷多的。其证明方式如下：
1. 假设素数是有限的，那么假设一共有$N$个素数，分别是:$p_1,...,p_N$.
2. 于是我们可以构造出一个$Q=\prod_{i=1}^{N}p_i$,那么我们可以断言$Q+1$同样是一个素数，因为任何已知的N个素因子都不是其因子，于是我们便构造出了第"N+1个素数"。这与一开始的假设是矛盾的，于是假设不成立，于是素数并非有限。

然后我们发现$Q+1$是一个非常有趣的结构，于是在此基础上我们想到与之有关的一个同样非常有趣的现象：

> [!Euler发现的现象]
> 序列$nQ+1,n\in \mathbb{Z}^{+}$的素因子里的素因子不属于集合$\{p_1,...,p_N\}$

这就表明，形如$nQ+1$的正整数，如果用素因分解表示都会是形如$\prod_{k\geq N+1}p_k^{a_k}$的形式。然后利用欧拉常用的一个技巧(这个技巧需要结合欧拉其他工作详细解释)把上面的现象与级数结合起来：

$$\sum_{n\geq 1}\frac{1}{nQ+1}\leq \sum_{r\geq 1}\left(\sum_{k>N }\frac{1}{p_k}\right)^r$$

那么如果说，级数$\sum_{p\in  \mathbb{P}} \frac{1}{p}$是收敛的，那么$S_N:=\sum_{k>N }\frac{1}{p_k}=o(1)$.严格地说就是，对任意$\varepsilon>0$都存在$N_{\varepsilon}$使得$S_{N_{\varepsilon}}<\varepsilon$。我们不妨令N是让$S_N<1/2$的正整数。那么上面不等式的右边就变成了$\sum_{r\geq 1}\frac{1}{2^r}$,这是一个收敛的级数，然而左边因为$\frac{1}{nQ+1}\sim \frac{1}{n}$(同阶的被求和对象求和，级数发散收敛性相同)，而自然数的倒数的和也就是调和级数是发散的，因此矛盾。

事实上，Meterns第二定理的结果在欧拉时代就已经被猜测是正确的，不过无论是欧拉的证明在现代眼光看来是错误的。在此以后Legendre也有过一个证明，不过也并非不符合现代意义下的严格证明。然后Chebyshev的证明最大的问题是，该证明是基于素数定理的，然而素数定理直到1896年才被真正证明。


### 2. Mertens的结果

Mertens在证明本文开始的那个结果的时候，还证明了两个辅助的命题：

> [!Mertens估计]
> 1. $$\sum_{n\leq x}\frac{\Lambda(n)}{n}=\log(x)+O(1)$$
> 2. $$\sum_{p\leq x}\frac{\log(p)}{p}=\log(x)+O(1)$$

#### 2.1 从第二个结果可以推出最终的结果

重新表述一下第二个结果:$$\begin{aligned}L(t)&:=\sum_{2\leq n\leq t}\frac{\log(n)}{n}\mathbf{1}_{\mathbb{P}}(n)\\&=\log(t)+R(t)\\&= \log(t)+O(1)\end{aligned}$$
其中$\mathbf{1}_{\mathbb{P}}(n)$是一个判断函数，如果$n$是素数，那么结果就是1，否则结果是0.并且此处的经验和[[连续分部求和法的基本用法]]当中问题3类似的经验，比如此处，我们要用分部求和把求和的一部分$L(t)$的展开结果带入到目标求和当中，而**目标求和是发散的，那么我们不能直接用$L(t)$的余项估计，而是要把余项精确地表达出来**。否则目标这个发散求和当中的常数项是我们搞不清楚的。因此此处我们用$R(t)$来表达这个余项。

同样的我们最终需要给出的结果可以表述为,$$S(x):=\sum_{2\leq n\leq x}\frac{1}{n}\mathbf{1}_{\mathbb{P}}(n)=\sum_{2\leq n\leq x}\frac{\log(n)}{n}\mathbf{1}_{\mathbb{P}}(n)\frac{1}{\log(n)}$$
于是我们想到可以利用分部求和的方式(参考[[和的积分估计]]当中的分部求和部分)从$L(t)$的渐近结果来得到$S(x)$的渐近结果，即:
$$\begin{aligned}S(x)&=\sum_{2\leq n\leq x}\frac{\log(n)}{n}\mathbf{1}_{\mathbb{P}}(n)\frac{1}{\log(n)}\\&=\frac{L(x)}{\log(x)} +C_1+\int_{2}^{x}\frac{L(t)}{t\log^2(t)}\,dt\\&= C_2+\frac{R(x)}{\log(x)}+\int_{2}^{x}\frac{1}{t\log(t)}\,dt+\int_{2}^x \frac{R(t)}{t\log^2(t)}\,dt\\&=\log\log(x)+C_3+\frac{R(x)}{\log(x)}+\int_{x}^{\infty}\frac{R(t)}{t\log^2(t)} \,dt\\&=\log\log(x)+C_3+O\left(\frac{1}{\log(x)}\right) \end{aligned}$$

于是我们边得到了最终的结果。

#### 2.2 第二个结果来自于第一个结果

因为第一个结果我们还可以表述为$\sum_{p^m\leq x}\frac{\log(p)}{p^m}$，而我们发现两个结果左边的函数的差实际上是$O(1)$,这就表明二者的渐近展开在精确到$O(1)$的级别上的时候是完全一致的。具体地来说，二者之差可以表达为:

$$\begin{aligned}\sum_{p^m\leq x,m\geq 2} \frac{\log(p)}{p^m}&=\sum_{p \in \mathbb{P}}\sum_{m\geq 2}\frac{\log(p)}{p^m}\mathbf{1}_{p^m\leq x}\\&= \sum_{p\in \mathbb{P}}\sum_{m\geq 2}\frac{\log(p)}{p^m}\\&\leq \sum_{p\in \mathbb{P}}\frac{\log(p)}{p(p-1)}\\&<\sum_{p\in \mathbb{P}}\frac{2\log(p)}{p^2}<\sum_{p\in \mathbb{P}}\frac{2\log(p)}{p^2}<+\infty\end{aligned}$$

#### 2.3 用算两次的想法求出第一个结果

> [!同物异表]
> 用两种不同的途径表示同一个对象，从而导出新的关系。

在这个问题当中，Mertens的做法是针对函数$f(x):=\sum_{n\leq x}\log(n)$进行两种不同的渐近展开：
1. 常用的渐近展开的方式:
$$f(x)=x\log(x)+O(x)$$
更为精确的结果可以参考[[Stirling渐近公式及不等式]].
2. **Dirichlet卷积法**:

这个想法的本质还是[[和以及积分换序]]当中的“求和换序”，即:

> [!卷积法]
> 我们把被求和对象当中的一部分展开为Dirichlet卷积的形式,然后交换求和次序，从而试图把对该数论函数的估计变成对更为熟悉且简单的数论函数的估计。

此处使用卷积法的契机是发现$\log(n)=\sum_{d|n}\Lambda(d)$,于是:$$\begin{aligned}f(x)&=\sum_{n\leq x}\sum_{d|n}\Lambda(d)\\&= \sum_{n\leq x}\sum_{d\leq x}\Lambda(d)\mathbf{1}_{d|n}\\&= \sum_{d\leq x}\Lambda(d)\sum_{n\leq x}\mathbf{1}_{d|n}\\&= \sum_{d\leq x}\Lambda(d)\left\lfloor\frac{x}{d}\right\rfloor\\&= x\sum_{d\leq x}\frac{\Lambda(d)}{d}+O\left(\sum_{d\leq x}\Lambda(d)\right)\\&=x\sum_{d\leq x}\frac{\Lambda(d)}{d}+O\left(\psi(x)\right) \\&= x\sum_{d\leq x}\frac{\Lambda(d)}{d}+O\left(x\right)\end{aligned}$$
注意到最后我们用到了Chebyshev在更早之前的关于第二Chebyshev函数$\psi(x):=\sum_{d\leq x}\Lambda(d)$的估计$\psi(x)=O(x)$.详细的证明可以见:[[Bertrand假设的证明]]当中的2.1的部分，里面有一个模仿Erdos风格的证明。

于是我们和原来的结果进行对比，我们可以得到$$x\sum_{d\leq x}\frac{\Lambda(d)}{d}-x\log(x)=O(x)$$
于是进而得到$$\sum_{n\leq x}\frac{\Lambda(n)}{n}=\log(x)+O(1)$$




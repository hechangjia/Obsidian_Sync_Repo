---
tags:
  - math
  - 微积分
  - 实分析
  - 概率论
---

> [!MIT积分竞赛]
> 求积分的结果：$$\int_{0}^{1}\left(\sum_{n\geq 1}\frac{\lfloor2^nx\rfloor}{3^n}\right)^2\,dx$$

关于这个问题我们首先利用[[用概率计算含参数积分的极限]]当中的一个观点，即我们可以把这种Lebesgue积分的积分变量替换为均匀分布的随机变量，然后把问题转换为概率积分。

$X(\omega)\sim U(0,1)$是概率空间$(\Omega,\mathcal{F},P)$上的一个复合均匀分布的随机变量，现在求概率积分:

> [!转换为概率积分]
> $$\int_{\Omega}\left(\sum_{n\geq 1}\frac{\lfloor2^nX(\omega)\rfloor}{3^n}\right)^2\,dP(\omega)$$或者说我们定义一个新的随机变量$Y(\omega)=\sum_{n\geq 1}\frac{\lfloor2^nX(\omega)\rfloor}{3^n}$，其中$X\sim U(0,1)$可以是**任意**一个均匀分布的随机变量。
> 那么现在要求概率积分$$\int_{\Omega}Y^2(\omega)\,dP(\omega)$$

在[[用概率计算含参数积分的极限]]的笔记中，我们这样做的目的是为了利用概率论当中对于随机变量收敛的结
果来达到计算含参数积分极限的目的。但是这里不同，这里我们要直接求积分的结果，而非极限的结果。其实这样做的想法来自于另外一个概率论当中的结果：

> [!命题1：对均匀分布的随机变量的二进制展开]
> 令$X_1,...,X_n,...$是概率空间$(\Omega,\mathcal{F},P)$当中的一列随机变量，定义$$Y(\omega):=\sum_{n\geq 1}\frac{X_n(\omega)}{2^n}$$那么
> 1. 如果$X_k \sim U(\{0,1\})$是一列独立同分布的随机变量,那么$Y\sim U(0,1)$是一个均匀分布的随机变量。
> 3. 如果$Y\sim U(0,1)$那么$X_k\sim$是一列独立同分布的且满足$X_k \sim U(\{0,1\})$的随机变量。

这个命题的第一部分不同于说，有独立同分布的伯努利随机变量定义出来的部分和序列$S_N(\omega):=\sum_{n\leq N} \frac{X_n(\omega)}{2^n}$，依分布收敛到某个均匀分布的随机变量(可以尝试结合Levy连续定理，计算部分和特征函数的极限)。而是说，我们现在依照逐点收敛的极限定义出一个随机变量$Y$,而这个随机变量一定是均匀分布的。

这里二进制展开的最直接的好处就是，我们可以去掉不太好处理的floor函数。然后根据[[和以及积分换序]]当中的想法，如果我们可以把被积分或者被求和当中的一部分展开为新的积分或者求和，这样我们交换一下次序，或者能把原来的问题得到简化。

#### 1. 该积分的处理

对随机变量做二进制展开以后，我们知道$$\begin{aligned}Y(\omega)&=\sum_{n\geq 1}\frac{\lfloor2^nX(\omega)\rfloor}{3^n}\\ &= \sum_{n\geq 1}\frac{1}{3^n}\sum_{k\leq n} b_k(\omega)2^{n-k} \\ &= \sum_{n\geq 1}\sum_{k\geq 1} b_k(\omega)2^{n-k}1_{k\leq n}\\ &= \sum_{k\geq 1}\sum_{n\geq 1} \frac{b_k(\omega)2^{n-k}}{3^n}1_{k\leq n} \\&= \sum_{k\geq 1}\frac{b_k(\omega)}{3^{k-1}}\end{aligned}$$其中$b_{k}(\omega)\sim U(\{0,1\})$是一列独立同分布的随机变量。

但是我们现在依旧需要面临一个问题，如果我们选择去展开计算$Y^2$，那么这条路并不容易。不过由于**独立性**，其方差倒是容易计算，那么利用方差与$L^2$范数之间的关系$$\int Y^2 \,dP = V(Y)+E^2(Y)$$
那么其中
$$\begin{aligned}V(Y)&=\sum_{k\geq 1} V\left(\frac{b_k(\omega)}{3^{k-1}}\right) \\ &= \sum_{n,j\geq 1} \frac{1}{3^{2k-2}}V(b_{k}(\omega)) \\ &= \sum_{n,j\geq 1} \frac{1}{3^{2k-2}} \frac{1}{4} \\ &= \frac{9}{32}\end{aligned}$$
然后计算其期望$$\begin{aligned}E(Y)&=\sum_{k\geq 1} E\left(\frac{b_k(\omega)}{3^{k-1}}\right) \\ &= \sum_{n,j\geq 1} \frac{1}{3^{k-1}}E(b_{k}(\omega)) \\ &= \sum_{n,j\geq 1} \frac{1}{3^{k-1}} \frac{1}{2} \\ &= \frac{3}{4}\end{aligned}$$
于是最后的结果$$\int_{\Omega} Y^2 \,dP=V(Y)+E^2(Y)=\frac{27}{32}$$
#### 2. 对二进制展开的证明

##### 2.1 命题的第一部分

> [!二进制表示]
> 此处我们讨论的二进制表示是无穷没有终止的二进制表示。这就好比，在十进制当中，我们就可以用$0.1$表示某个小数，但是我们选择用$0.09999...$来表示同一个实数。在二进制当中也是类似的做法，这样的好处是，每一个小数都对应一个无穷序列。

我们需要证明由一列独立同分布的伯努利随机变量$X_k(\omega)\sim U(\{0,1\})$求和得到的随机变量$Y(\omega)$是均匀分布的。我们的想法是：

> [!基本想法]
> 直接算其累积分布函数$F_{Y}(y)$，如果我们可以得到$F_{Y}(y)=y$那么$Y$一定是$U(0,1)$的随机变量。

不过我们立刻注意到一个困难，$P(Y<y),y\in (0,1)$可不好算，因为$Y$是级数表达的一个对象。不过我们转念一想，如果$y$也是二进制表达的，那么此时比大小会容易许多。我们可以回忆一下二进制数比大小的基本原则，

> [!r进制的两个小数比大小]
> 假设两个实数$a,b\in (0,1)$其$r$进制表示的前$k$位($k\geq 1$)都相等，第$k+1$位上的数字$a_{k+1}>b_{k+1}$，那么$a>b$.

那么现在假设$A=\{\omega:Y(\omega)<y\},y\in (0,1)$.并且假设$y=\sum_{k\geq 1}\frac{y_k}{2^k},y_k \in \{0,1\}$，那么$A = \bigcup_{k\geq 1}A_k$,其中$$A_k:=\left(\bigcap_{j\leq k-1}\{\omega:X_i(\omega)=y_i\}\right) \cap \{\omega:X_{k}(\omega)<y_k\}$$
也就是说$$\begin{aligned}A&=\{\omega:X_{1}(\omega)<y_1\}\\ &\cup(\{\omega:X_{1}(\omega)=y_1\}\cap \{\omega:X_{2}(\omega)<y_2\}) \\ &\cup(\{\omega:X_{1}(\omega)=y_1\}\cap \{\omega:X_{2}(\omega)=y_2\}\cap \{\omega:X_{2}(\omega)<y_3\})\\ &\cup ... \end{aligned}$$
那么其概率测度我们现在就可以给出$$\begin{aligned}P(A)&=\sum_{k\geq 1} P(A_k)\\ &= \sum_{k\geq 1} \frac{1}{2^{k-1}}\frac{y_k}{2} \\ &= y \end{aligned}$$
也就是说，我们得到结论$$P(Y<y)=y$$
因此$Y\sim U(0,1)$.

##### 2.2 命题的第二部分

第二部分我们要证明，如果$Y \sim U(0,1)$那么，如果我们对其做二进制表示，那么二进制小数上的数字互相之间都是$U(\{0,1\})$的伯努利随机变量。

假设$x_k(\omega)$是$Y$的二进制表示的第$k$位上的数字，其值域为$\{0,1\}$.首先我们可以来考虑，假设前$n$位二进制表示确定下来的概率是多少。即考虑$Y$的二进制展开的前n项为$0.x_1...x_n...$的集合的概率，也就是，$$\{\omega:X_1(\omega)=x_1 \text{ and } ... \text{and } X_n(\omega)=x_n\}$$这个集合的概率测度。我们知道对于任意自然数$n\geq 1$都有，以$.x_1...x_n...$开始的二进制小数都落在区间$(d,d+\frac{1}{2^n}]$当中(这一点在图像上极其显然)，其中$d=\sum_{k\geq 1}\frac{x^k}{2^k}$.于是我们得到两个重要信息，首先$$P(\{\omega:X_k(\omega)=x_k\})=\frac{1}{2}$$然后$$P(\{\omega:X_1(\omega)=x_1 \text{ and } ... \text{and } X_n(\omega)=x_n\}) = \frac{1}{2^n}$$
也就是说前n个随机变量之间，$X_k \sim U(\{0,1\})$并且互相独立。

#### 2.3 推广到$r$进制

如果在任意进制内能成立，那么会非常方便。比如说，这样一个问题:

> [!Cantor集合的Lebesgue测度]
> 定义Cantor集合$C$为闭区间$[0,1]$的一个子集，其元素由那些三进制表示中不包含数字1的$[0,1]$中的实数构成。$m$是实数上的Lebesgue测度，那么$$m(C)=0$$

那么假设上面的结论对于任意进制都是成立的，那么当然也对三进制成立。那么我们可以考虑$[0,1]$上的均匀分布的随机变量$Y(\omega):=\omega$.此时的概率空间为$(\mathbb{R},\mathcal{B}(\mathbb{R}),m)$,也就是说此时概率测度就是Lebesgue测度。此时$Y$的三进制展开的每一位$X_k(\omega)$都是独立同分布的$U(\{0,1,2\})$的随机变量.那么我们知道:

$$m(C):=\prod_{k\geq 1} m(\{\omega:X_k(\omega)\neq 1\})=\prod_{k\geq 1} \frac{2}{3}=0$$

更多的应用:
* [[单位区间内10进制小数中含有无数个7的小数的Lebesgue测度为1]]在这个问题当中我们把关于Lebesgue测度的问题转换为概率问题，因为我们知道10进制表示当中每一位数都是独立同分布的$U(\{0,1,...,9\})$的随机变量。然后我们观察到，问题当中说的十进制小数中包含无穷多个7，我们很快想到了这等于是求$P(\omega \in A_k \text{ i.o.})$。这样我们只需要考虑每一位为7的事件的概率，以及这些事件是否独立，而这些条件显然可以被满足，因此考虑使用第二Borel-Cantelli lemma.
* 

---
该命题的证明完全是参照二进制的版本。证明的第一部分我们完全不需要修改，只需要注意$y_k \in \{0,1,...,r-1\}$即可。第二部分的证明，我们只需要注意到以$.x_1...x_n...$作为开头的r进制小数，都会落在$(d,d+\frac{1}{r^n}]$的区间当中,因此同样的有$$P(\{\omega:X_k(\omega)=x_k\})=\frac{1}{r}$$以及
$$P(\{\omega:X_1(\omega)=x_1 \text{ and } ... \text{and } X_n(\omega)=x_n\}) = \frac{1}{r^n}$$
至此便可以把命题从二进制推广到r进制。


---
tags:
  - math
  - 大学数学竞赛
---

> [!大学生数学竞赛题目]
> 求极限:
> $$\lim_{n\to \infty}\sum_{k=1}^{n}\frac{n}{n^2+k^2+1}$$


其实这类关于含参数的函数列的和的极限问题，相当于就是得到其部分和的渐近展开的常数项。也就是说$$\sum_{k\leq n} f(n,k)=A+o(1)$$整个问题对渐近的精度要求到上面的程度即可。

### 1. 利用黎曼和对积分的近似

#### 1.1 当部分和恰好是一个黎曼和的时候

在本问题当中，原来的和可以改写为$$S_n=\frac{1}{n}\sum_{k\leq n }\frac{1}{1+(\frac{k}{n})^2+\frac{1}{n}}$$我们观察到于这个结果比较类似的一个和恰好是一个较为简单的函数的黎曼和$$S_n'=\frac{1}{n}\sum_{k\leq n }\frac{1}{1+(\frac{k}{n})^2}$$按照[[黎曼和对积分的近似]]当中的1.1当中的结论，由于函数可微，那么其渐近展开可以写为$$\begin{aligned}S_n'&=\int_{0}^{1}\frac{1}{1+x^2}\,dx+O\left(\frac{1}{n}\right)\\&= \frac{\pi}{4}+O\left(\frac{1}{n}\right)\end{aligned}$$那么我们的想法可以总结为:


> [!命题1]
> 如果我们对$S_n$的渐近展开的精度要求为$O(g(n))$,而此时恰好有另一个已知渐近展开结果，且精度也为$O(g(n))$的和$S'_n$，同时$$S_n-S_n'=O(g(n))$$那么$S_n,S_n'$的渐近展开在$O(g(n))$的精度下是相同的。

> [!想法]
> 命题1告诉我们，如果你发现一个$S_n'$其形式比$S_n$更好得到渐近展开，比如说对$S_n$做某种放缩，只要放缩整体的误差是被$O(g(n))$控制起来的，那么最终的渐近展开是相同的。

要实现这个目的我们还可以考虑一个更容易分析的情形，即如果$\sum_{k\leq n }$每一项的误差在$O(1/n)$求和以后整个部分和的误差内积起来不超过$O(1)$,于是$\frac{1}{n}\sum_{k\leq n }$以后误差就是$O(1/n)$。

要求$$\left|\frac{1}{1+(\frac{k}{n})^2+\frac{1}{n}}-\frac{1}{1+(\frac{k}{n})^2}\right|=O(1/n)$$也就是说要求$$\frac{1}{(1+(\frac{k}{n})^2+\frac{1}{n})(1+(\frac{k}{n})^2)}=O(1)$$这是显然的。因此$$S_n = \frac{\pi}{4}+O(1/n)$$
### 2. 直接考虑[[和的积分估计]]

#### 2.1 简单积分估计

因为问题的精度要求不高，因此不妨仅仅考虑简单的积分估计。假设$f_n(t)=\frac{n}{n^2+t^2+1}$因为被求和对象$f_n(t)$对于固定的$n$是一个单调减少的函数，于是$$\begin{aligned}S_n &= \int_{1}^{n}f_n(t)\,dt+O(|f_n(n)|+|f_n(1)|)\\&=  \frac{n}{\sqrt{n^2+1}}\left(\arctan(\frac{n}{\sqrt{n^2+1}})-\arctan(\frac{1}{\sqrt{n^2+1}})\right)+O(1/n)\\&= \frac{\pi}{4}+O(1/n)\end{aligned}$$
#### 2.2 用Euler-Macluarin求和提高渐近精度







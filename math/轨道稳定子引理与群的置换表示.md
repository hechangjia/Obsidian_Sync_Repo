---
tags:
  - math
  - 代数基础
  - 组合学
---

### 1. 从一个计数问题开始

> [!问题1]
> 假设有一条项链，一共有8颗珠子组成，每颗珠子可以有四种不同的涂色方式，请问整条项链一共有多少种着色方式?

首先第一反应，因为一共有8颗珠子，并且每种涂色有四种，那么一共有 48 种组合方式？可是这样是错误的，因为按照常理思考，**一串珠子，假设我顺时针拨动它，那么它应该还是同一种着色。**

例如下面的着色应当都是同一种着色，因为本质上都只不过是把项链进行顺时针旋转罢了。

![[项链着色问题.webp]]
因此我们**实在没有理由认为，把一串珠子顺时针旋转后得到的是不同的着色，但是 48 种组合里面却是包含了这样的组合。**

再者，我们同样可以考虑把这串珠子反转过来，也就是沿着某一条对称轴，做对称，这样得到的结果按道理也应该算是同一种着色。

因此我们不难发现，其实，在$4^8$种组合里面有许多这样的应该归类为同一种着色的组合，也就是一个等价类。那么怎样定义这个等价类呢？

首先要搞清楚，怎样的着色应该算是同一种着色。按照的分析，我们可以认为，如果一串(可以理解为正多边形的)着色的珠子，可以通过某一种旋转或者对称反射的方式(或者他们的复合)，转化为y，那么称着色x与着色y等价，记为$x\sim y$。

那么一串珠子一共有哪些对称和反射呢？自然是这个几何图形的对称群决定的。问题中的8个珠子组成的项链，可以等价为一个正8边形，因此对称群自然是八阶Dihedral群$D_8$。(为何？参考[[为何平面正多边形的对称群为Dihedral group]])

这个道理可以归结为：

如果存在$g\in D_8$以及这串珠子的两种着色$x,y$使得$g\cdot x =y$那么称$x,y$是两种等价的着色。定义$$O_a:=\{g\cdot a:g\in D_8\}$$
这里$a=(c_1,...,c_8)$表示这串珠子每个点的着色的情况，例如问题中说珠子一共有四种着色方式，不失一般性可以假设$c_i \in \{\mathbf{\color{red}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{yellow}{\square}},\mathbf{\color{green}{\square}}\}$.那么按照这种记号，一种特定的珠子着色可以写为$$a=(\mathbf{\color{green}{\square}},\mathbf{\color{yellow}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{red}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{green}{\square}},\mathbf{\color{orange}{\square}})$$
于是$O_a$这个集合实际上就表示与$a$在$D_8$的作用(旋转和反射的各种复合)下等价的着色。于是我们最终需要回答的就是，在集合$$E=\{x=(c_1,...,c_8):c_i \in \{\mathbf{\color{red}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{yellow}{\square}},\mathbf{\color{green}{\square}}\}\}$$当中有多少个不同的集合$O_x$，也就是说我们需要知道集合$$\{O_x:x\in E\}$$的大小。

### 2.群论的一些语言

以上内容我们将之翻译为群论的语言。
*  **群的作用**: 我们对集合$X$，也就是所有着色后的项链的集合进行诸如旋转，反射以及他们的复合等等操作的时候，实际上定义了某种$$f:G\times X\to X$$比如在刚才的例子当中，我们给一种来自于$D_8$的元素$r$,表示顺时针旋转$\frac{2\pi}{8}$,然后选某一个着色的项链的集合当中的元素$a=(\mathbf{\color{green}{\square}},\mathbf{\color{yellow}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{red}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{green}{\square}},\mathbf{\color{orange}{\square}})$那么旋转后的项链就会变成$b=(\mathbf{\color{yellow}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{red}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{green}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{green}{\square}})$所以实际上我们通过某种映射完成了$$(g,a)\mapsto b$$的这样一个映射。不过这样的映射如果用$f$来表示有点麻烦，我们会经常使用$$\cdot:G\times X\to X$$也就是类比乘法一样来表示。按照这样的记号，那么可以把这里的例子写为$$g\cdot a =b$$
* **轨道**: 简而言之就是让群里面所有元素作用在同一个元素上所形成的一个集合。群$G$作用在集合$X$下的某元素$x$
的轨道可以表示为$$\text{Orb}_x=G\cdot x:=\{g\cdot x:g\in G\}$$
这个术语的名称是类比于物理当中物体运动的轨迹。把集合当中某个固定的点$x$想象成空间当中的点，然后群当中的元素相当于是推动这个点运动的力，然后由于这样的力的推动点开始运动，这些运动留下的轨迹$g\cdot x$便是轨道。

所以一开始的问题可以用术语阐述为:

> [!问题2：问题的抽象化]
> $D_8$作用在集合$E=\{x=(c_1,...,c_8):c_i \in \{\mathbf{\color{red}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{yellow}{\square}},\mathbf{\color{green}{\square}}\}\}$
> 可以形成多少个不同的轨道?

不过轨道的数量直接去数是不容易的。下面是按照定义去数集合$X$在群$G$作用下轨道的数量的流程:
1. 任选一个固定的$x_1 \in X$然后算出$O_{x_1}$。
2. 在集合$X$当中排除第一条轨道，得到$X_1$，然后从此集合当中再找一个固定的元素$x_2$，然后计算出第二条轨道$X_2$。
3. 重复上述过程直至最后$X_{n+1} = \varnothing$，那么集合在群$G$的作用下一共就有$n$条轨道。

然而这样并不好算，比如本文中的这个项链着色的问题，集合$E$的元素的个数就有$4^8$个，而单个轨道的最大元素个数是16，也就是说每次我们最多排除16个元素，因此我们需要经过相当多的循环才能最终确认轨道的数量。

而Burnside给我们提供了一种更为简单的计算轨道数量的方法。如果我们用$X/ G$表示全体轨道的集合，那么Burnside告诉我们

> [!Burnside lemma]
> $X/ G$表示集合$X$在有限群$G$作用下的全体轨道的集合，那么集合元素的个数可以表示为
> $$|X/G|=\frac{1}{|G|}\sum_{g\in G}|X^g|$$
> 其中$X^g$表示集合$X$中所有的在群元素$g$的作用下保持不变的元素组成的集合。$$X^g:=\{x\in X:g\cdot x =x\}$$

* 换言之，群$G$上的元素作用在$X$上的不动点的数目的平均值就是这个作用的不同轨道的数目。

这个方法的高明之处在于，给定一个群的元素$g$,我们往往能通过一些群元素的几何或者代数性质来直接确定$X^g$的大小，而不需要真的一个个去尝试。

比如说给一种来自于$D_8$的元素$r$,表示顺时针旋转$\frac{2\pi}{8}$,然后考虑集合$E$当中哪些元素是在$r$的作用下保持不变的，我们很容易就得出只有所有颜色都一样的项链才能保持这种不变性，因此我们立刻就知道$|E^{r}| =4$.这就要比按照定义去计算轨道要来的快得多。

而证明这个结果需要考虑一个在数量上和轨道有关系的概念。
* **稳定子**：集合的元素$x$在群作用下的稳定子实际上是群$G$的一个子群，它包含那些对元素$x$不起作用的群的元素，记作$G_x$:$$G_x:=\{g\in G:g\cdot x=x\}$$
为什么$G_x$在Burnside问题中有关系呢？因为$$\sum_{g\in G}|X^g|=\sum_{x\in X} |G_x|$$
因为两个求和都表示集合$G\times X$当中所有那些满足等式$g\cdot x =x$的元素$(g,x)$的集合的元素个数，只不过两个等式采用了两种不同的奇数方法。

而后者中涉及的稳定子的尺寸与轨道的尺寸，以及群的尺寸之间有直接的关系，这个关系被称之为**轨道-稳定子引理(Orbit-stabilizer lemma)**。

### 3.轨道-稳定子引理

> [!轨道-稳定子引理]
> 群$G$作用在集合$X$上，$x\in X$是集合中一个固定的元素，那么$$|G|= |O_x|\text{ }|G_x|$$其中$O_x$表示$x$在群作用下形成的轨道，$G_x$表示所有对$x$不起作用的群的元素形成的稳定子。

其本质是群的第一同构定理，对于$x$我们可以定义一个$G\to X$的定义为$f_x:g\mapsto g\cdot x$的映射那么：
1. 此映射的像是$x$的轨道，即$\text{im}f_x=O_x$。
2. 此映射的核是$x$对应的稳定子即$\text{ker}f_x=G_x$。
3. 那么群$G$关于映射的核$G_x$的陪集做成的集合$G/G_x$的数量和映射的像的数量一样，也就是$$|G/G_x|= |O_x|$$这个关系主要是来自于[[第一同构定理]]。这并非群的第一同态，集合$X$并非群，我们单纯从集合的角度理解$$G \twoheadrightarrow G/\text{ker}f_x
\overset{\sim}{\to}\text{im} f_x \hookrightarrow
X$$
4. 而陪集的集合$G/G_x$的数目一共是多少呢？当然就是子群$G_x$在群$G$中的指数，根据Lagrange定理实际上就是$\frac{|G|}{|G_x|}$因此便有了这个结果。

从这里也能看得出来引入轨道，稳定子的想法是自然的。因为我们定义了$f:G \times X\to X$的群的作用，这就是一个二元的映射$f(g,x)\in X$，对于这种映射一个自然的想法是固定其中一个元素，如果我们固定$x=x_0$，那么我们也就得到了一个$G\to X$的映射$f_{x_0}=f(g,x_0)$。而此映射的像与核分别是$x_0$的轨道与稳定子。

按照这种理解，我们可以证明Burnside的结果:

$$\begin{align}\sum_{g \in G}\left|X^{g}\right|&=\sum_{x\in X}|G_{x}|\\ &=|G|\sum_{x\in X}\frac{1}{|O_x|}\\ &=|G|\left(\sum_{O_{x_i}\in X/G}\left( \sum_{x \in O_{x_i}}\frac{1}{|O_{x_i}|}\right) \right)\\ &=|G|\sum_{O_{x_i}\in X/G} |O_{x_i}|\cdot \frac{1}{|O_{x_i}|}\\ &= |G|\cdot |X/G| \end{align}$$

第三个等式中，我们把整个集合$X$分为了一条条轨道，在每个轨道$O_{x_i}$的长度为$|O_{x_i}|$,于是便有了上面的证明。

### 4. 群的置换表示

Burnside的方法当中我们只需要计算$|X^g|$的数量就可以完成计数，而Burnside之所以选择计算$|X^g|$而不是稳定子$|G_x|$是因为我们可以利用群$G$的某些几何或者代数的性质去直接得到结果而不是一个个去尝试。这一点可以从群的置换表示出发。

这样做的依据是Cayley定理：

> [!Cayley定理]
> n阶有限群$G$与n阶置换群$\text{Sym}(G)$的某个子群同构。

这个定理的道理是这样的:

我们直接考虑群作用在自己(组成群的这个集合)上面，那么此时的群作用"$\cdot$"就是群的自己二元运算。也就是$$g,x\in G,g\cdot x = gx$$
如此一来每当我们固定一个$g$然后作用在集合$G$上，便得到了一个$f_g:G\to G$的置换($G \ni gx\mapsto y\in G$,然后这是一个双射,集合到自己的双射称之为置换)。这些置换互相之间也存在一个二元运算，即$f_g\circ f_h(x) =gh x$,而我们可以证明这些置换构成一个群，而此群是置换群$\text{Sym}(G)$的一个n阶子群。

我们现在要证明$G$与这个子群是同构的，这一点可以从[[第一同构定理]]入手。这里存在一个映射$\varphi:g\mapsto f_g$，这是一个$G\to \text{Sym}(G)$的同态映射，我们姑且称之为"G的置换表示"。首先这是一个单射(faithful)，因此$\text{ker}\varphi = e$.那么按照同态定理，$$G/\text{ker}\varphi \simeq \text{im}\varphi$$
因为单射的缘故实际上$G\simeq G/\text{ker}\varphi$而$\text{im}\varphi$就是$\text{Sym}(G)$的子群。

---
那么基于以上的道理，我们可以用置换来表示群$G$当中的元素。具体的操作可以归纳为这样的过程:
1. 首先把n阶群$G$当中的n个元素和集合$\{1,...,n\}$建立起一个双射。不妨令这个双色为$f:\{1,...,n\}\to G$.那么此时$$G=\{f(1),...,f(n)\}$$
2. 考虑群$G$对自身的作用。任意一个$g \in G$作用在集合$G$上，建立起来一个$\pi_g:G\to G$,从而使得$$\pi_g(f(1))=g\cdot f(i_1),...,\pi_g(f(n))=g\cdot f(n)=f(i_n)$$于是我们得到一个置换$$\pi_g\circ f=\begin{pmatrix}1,...,n\\i_1,...,i_n \end{pmatrix}$$
3. 假设这些置换形成一个新的群称之为$G'$。最后Cayley定理告诉我们，$G \simeq G'$.

---
放到本文提到的问题当中考虑：

1. $(1,2,3,4,5,6,7,8)$其实就是群$D_8$当中的逆时针旋转$\frac{2\pi}{8}$，放在着色的项链的问题里面，相当于把项链转换一颗珠子。比如这个置换作用在$a=(\mathbf{\color{green}{\square}},\mathbf{\color{yellow}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{red}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{green}{\square}},\mathbf{\color{orange}{\square}})$上便会得到$(\mathbf{\color{yellow}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{red}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{green}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{green}{\square}})$.这个置换的表达方法也很简单，就是把这一列数字理解为轮换，也就是$1\to 2$,然后$2\to 3$,最后$7\to 8$.表示把位置1上的东西交换到位置2上面，然后一直进行下去直到把位置7的东西交换到位置8上。
2. $(1,5)(2,4)(6,8)$这个置换的含义就相当于是轮换当中出现了"循环".也就是$1\to 5$互相对调，把位置1的东西换到位置5，把位置5的东西换到位置1，不与其他任何位置的东西产生影响。

而置换能帮助我们更好观察计算$|X^g|$的规律。现在我们来考虑一个小问题：

> [!问题3]
> 假设有一个置换$g = (1,3,5)(2,4,6)(8,7)$,集合为$E=\{x=(c_1,...,c_8):c_i \in \{\mathbf{\color{red}{\square}},\mathbf{\color{orange}{\square}},\mathbf{\color{yellow}{\square}},\mathbf{\color{green}{\square}}\}\}$那么请问集合$E^g$当中包含了哪些元素，以及这个集合有多大？我们能从这个问题当中得到什么规律?

也就是说我们需要寻找$x\in E$使得在置换$g$的作用下保持不变的元素。我们可以直接用计算机来遍历这个问题，然后观察其中的规律.

```wolfram
(*定义置换群*)
h = Cycles[{{1, 3, 5}, {2, 4, 6}, {7, 8}}];

(*定义一个函数用来判断两个列表是否相等*)
sameList[list1_, list2_] := list1 === list2;

(*生成所有可能的颜色组合*)
X = Tuples[{Red, Green, Blue, Yellow}, 8];

(*定义一个函数来获取结果*)
f[x_] := If[sameList[Permute[x, h], x], x, Nothing];

(*计算结果*)
result = DeleteCases[f /@ X, Nothing];

(*输出结果*)
Length[result]  (*输出有效着色的总数*)
result          (*显示所有结果*)
```
下面是我们得到的结果
![[在某个置换下保持不变的集合的元素.png]]
观察这个结果我们发现一个明显的规律：**置换的循环里面的颜色保持不变的那些元素在此置换下保持不变。**

仔细想想这是很显然的事情，因为某个循环的位置上颜色一致的话，这几个位置的颜色无论怎么互相交换，最后得到的还是一摸一样的结果。那么因为$$g = (1,3,5)(2,4,6)(8,7)$$这个置换有三个循环，然后每个循环里面的颜色要保持一致，那么实际上$|E^g| =4^3$,因为每个循环里面的位置上可以选择4种颜色。

---
上面的例子给了我们一个启发，我们**实际上只需要搞清楚$D_8$的置换表示当中，每个置换有多少个循环，那么问题2当中的计数问题也就解决了。** (这实际上就是Polya定理的一个具体体现)

这里我们可以先看看$D_8$的置换表示，这里使用的工具是SageMath，不过这是基于Python开发的工具，因此语法上和Python是一摸一样的。
```python
DihedralGroup(8).list()
```
得到的结果是
```Python
[(),
 (1,5)(2,6)(3,7)(4,8),
 (1,7,5,3)(2,8,6,4),
 (1,3,5,7)(2,4,6,8),
 (1,8,7,6,5,4,3,2),
 (1,4,7,2,5,8,3,6),
 (1,6,3,8,5,2,7,4),
 (1,2,3,4,5,6,7,8),
 (2,8)(3,7)(4,6),
 (1,5)(2,4)(6,8),
 (1,7)(2,6)(3,5),
 (1,3)(4,8)(5,7),
 (1,8)(2,7)(3,6)(4,5),
 (1,4)(2,3)(5,8)(6,7),
 (1,6)(2,5)(3,4)(7,8),
 (1,2)(3,8)(4,7)(5,6)]
```

所以其实我们完全可以根据这个结果把问题1，问题2的结果写出来。

> [!问题1,2的解答]
> $D_8$当中
> 1. 一共有5个由4个循环构成的置换。这样的置换每一个$|E^g|=4^4$
> 2. 一共有4个由5个循环构成的置换。这样的置换每一个$|E^g|=4^5$.这里要注意$(1,3)(4,8)(5,7) = (1,3)(4,8)(5,7)(2)(6)$，其中位置2不换，位置6也不换表示的时候往往省略，但是要注意这也是一个循环，这两个位置上的颜色是任意的。
> 3. 一共有4个由1个循环构成的置换。这样的置换每一个$|E^g|=4^1$.
> 4. 一共有2个由2个循环构成的置换。这样的置换每一个$|E^g|=4^2$.
> 5. 以及一个单位元，其对应的$|E^g|= |E|=4^8$.
> 
> 那么我们便可以根据Burnside lemma得到$$\begin{aligned}|E/D_8|&=\frac{1}{|D_8|}\sum_{g\in D_8} |E^g|\\ &= \frac{1}{16} (5\times 4^4+4\times 4^5+4\times 4^1+2\times 4^2+4^8)\\ &= 4435\end{aligned}$$
> 这便是这个问题最后的结果。



















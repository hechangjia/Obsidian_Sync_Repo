---
tags:
  - math
  - 微积分
---

> [!问题(某年高考数学)]
> 证明对任意正整数$n$都有，$$\sum_{k = 1}^{n} \frac{1}{\sqrt{k^2+k}} > \log(n+1)$$

### 1. 尝试简单积分估计

根据[[和的积分估计]]中第1节的叙述的内容，我们需要简单三点才能确定这里适合做一个简单的积分估计：
1. 是否单调?
2. 误差是否合适?
3. 积分是否足够简单(或者熟悉)?

第一条要求中的单调性是显然的，第三条当中的积分，由于$$\int_{a}^{b}\frac{1}{\sqrt{t^2+t}}dt=2\text{arcsinh}(\sqrt{b})-2\text{arcsinh}(\sqrt{a})$$也勉强可以算作是熟悉。至于误差我们就需要更为仔细地分析。

由$$\begin{aligned}S_n&>S_{a-1}+\int_{a}^{n+1}\frac{1}{\sqrt{t^2+t}}dt\\&=S_{a-1}+2\text{arcsinh}(\sqrt{n+1})-2\text{arcsinh}(\sqrt{a})\end{aligned}$$于是我们现在的问题就变成了:
> [!问题1.1]
> 是否存在一个正整数$a$，使得$$S_n>S_{a-1}+2\text{arcsinh}(\sqrt{n+1})-2\text{arcsinh}(\sqrt{a})$$对任意的正整数$n$成立?

我们可以根据后者的Taylor展开，得到渐近表达$$\log(n)+2\log(2)-2\text{arcsinh}(\sqrt{a})+S_{a-1}+O\left(\frac{1}{n}\right)$$我们可以根据Taylor展开的余项，从而证明,对任意正整数$a$,都有不等式$$S_{a-1}+2\text{arcsinh}(\sqrt{n+1})-2\text{arcsinh}(\sqrt{a})>\log(n)+2\log(2)-2\text{arcsinh}(\sqrt{a})+S_{a-1}$$也就是说我们现在只需要证明一个加强的结果:

> [!问题1.2]
> 是否存在一个正整数$a$，使得$$\log(n)+2\log(2)-2\text{arcsinh}(\sqrt{a})+S_{a-1}>\log(n+1)$$对任意的正整数$n$成立?

简化一下这个形式，即证明$$\log\left(\frac{n}{n+1}\right)>2\text{arcsinh}(\sqrt{a})-2\log(2)-S_{a-1}$$
至此其实我们看得出，要实现这一条路径遇到的麻烦是很多的。这其实体现了，简单的积分估计所能提供的精度是比较低的。特别是本文中这种需要对一个发散的级数的部分和的渐近系数的常数项做估计。
### 2.使用Euler-Maclaurin求和估计进行进行估计

相当于我们继续做积分估计，只不过我们做的比上面的简单积分估计更细致一些。

首先我们来分析一下这个问题的精度要求：

```wolfram
S[n_] := Sum[1/Sqrt[k^2 + k], {k, 1, n}];
DiscretePlot[S[n] - Log[n + 1], {n, 1, 600}]
```

![[目标精度要求是如何的.png]]
这意味着，我们要的下界估计的精度是假设$$S_n=\log(n)+C+O\left(\frac{1}{n}\right)$$其中我们需要给到估计，$C>0$。

#### 2.1 启用Euler-Maclaurin求和估计
此方法的具体内容可以参考[[和的积分估计]]以及其中的案例。
1. **积分主项**:
实际上积分是可以计算出来的，$$\begin{aligned}\int_{1}^{n}\frac{1}{\sqrt{t^2+t}}\,dt&=2\text{arsinh}(\sqrt{n})-2\text{arsinh}(1)\\&=\log(n)+(2\log(2)-2\text{arsinh}(1)) +O(1/n)\end{aligned}$$
2. **中间项**:
$$\begin{aligned}\frac{1}{12}\left(\frac{3}{4\sqrt{2}}-\frac{2n+1}{2(n^2+n)^{3/2}}\right)+\frac{1}{2} \left( \frac{1}{\sqrt{2}} + \frac{1}{\sqrt{n + n^2}} \right)
=\frac{9}{16\sqrt{2}}+o\left(\frac{1}{n}\right)\end{aligned}$$

3. **余项**：
此处的余项的处理是我们的重点，因为我们最终确定渐近展开的常数项，其中会有一部分需要用到最后的积分余项来进行表示。

令$f(t):=\frac{1}{\sqrt{t^2+t}}$,那么余项$$R_n = \frac{1}{6}\int_{1}^{n}B_3(\{t\})f^{(3)}(t)\,dt$$
其中$$f^{(3)}(t)=-\frac{15 (1 + 2t)^3}{8 (t + t^2)^{7/2}} + \frac{9 (1 + 2t)}{2 (t + t^2)^{5/2}}
=O\left(\frac{1}{t^4}\right)$$
于是我们知道余项的积分，$A=\int_{1}^{\infty}B_3(\{t\})f^{(3)}(t)\,dt$是收敛的,于是我们可以着手把余项改写为$$\begin{aligned}R_n&=-\frac{A}{6}+O\left(\int_{n}^{\infty}\frac{1}{t^4}\,dt\right)\\&= -\frac{A}{6}+o\left(\frac{1}{n}\right)\end{aligned}$$
#### 2.2 分析常数项

所以现在我们知道和式的最终展开为:
$$S_n=\log(n)+2\log(2)-2\text{arsinh}(1)+\frac{9}{16\sqrt{2}}-\frac{A}{6}+O\left(\frac{1}{n}\right)$$
而其中常数项，$$\begin{aligned}C&=2\log(2)-2\text{arsinh}(1)+\frac{9}{16\sqrt{2}}-\frac{A}{6}\end{aligned}$$
也就是说常数项$C$是否大于0，取决于最后我们对$A$的估计。其中$$\begin{aligned}|A|&\leq \left|\int_{1}^{\infty}B_3(\{t\})f^{(3)}(t)\,dt\right|\\&\leq \frac{3\zeta(3)}{2\pi^3}\int_{1}^{\infty}|f^{(3)}(t)|\,dt=-\frac{3\zeta(3)}{2\pi^3}\int_{1}^{\infty}f^{(3)}(t)\,dt\\&= \frac{3\zeta(3)}{2\pi^3}\frac{19}{16\sqrt{2}}\end{aligned}$$其中对周期函数$B_3(\{t\})$的上界的估计，可以参考[[和的积分估计]]当中Euler-Maclaurin求和估计的部分。因此$$\begin{aligned}C&>2\log(2)-2\text{arsinh}(1)+\frac{9}{16\sqrt{2}}-\frac{1}{6}\frac{3\zeta(3)}{2\pi^3}\frac{19}{16\sqrt{2}}\\&>0.013\end{aligned}$$
因此问题得到解决。
### 3.从结果开始逐项放缩 

> [!这个做法的核心动机]
> 如果我们可以把右边拆分成新的求和，那么问题转换为两个求和比大小的问题，那么是否只要求和逐项比大小就可以了。

而这里的新的求和，最简单的就是把函数表示为其差分和。这不禁让我们联想到[[序列差分的部分和与Riesz-Fischer定理]],以及[[非负序列差分的约束条件导致序列收敛]]提到的观点，认为则可以理解为离散形式的“微积分基本定理”。

也就是说如果能证明，$$\log(k+1)-\log(k)<\frac{1}{\sqrt{k^2+k}}$$就好了。事实上这是可以办到的，我们注意到差分本身也可以理解为是两个原函数做差，于是联想到微积分基本定理，于是:
$$\begin{aligned}\log(k+1)-\log(k) &= \int_{0}^{1} \frac{1}{k+t}dt\\ &< \left(\int_{0}^{1}\frac{1}{(k+t)^2}dt\right)^{1/2}= \sqrt{\frac{1}{k^2+k}}\end{aligned}$$
当然上述的证明还有很多其他办法，包括求最值之类的。总之最后左边是一个telescoping sum的形式，那么$$\log(n+1)=\sum_{k=1}^{n}(\log(k+1)-\log(k)) <\sum_{n=1}^{N} \sqrt{\frac{1}{k^2+k}}$$
因此不等式显然成立。


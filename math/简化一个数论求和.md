---
tags:
  - math
  - 数论
  - 解析数论
---

> [!问题]
> 简化下面的求和$$f(n):=\sum_{\begin{aligned}k\leq& n\\ (k,n)&=1\end{aligned}} \cos\left(\frac{2k\pi}{n}\right)$$其中$(k,n)$表示最大公因数。

其基本的想法来自于[[把条件函数展开为新的求和然后换序]]，模仿其中典型例子1.1当中的操作，我们首先把条件$(k,n)=1$转换为一个求和，然后使用交换求和次序的技巧。

$$\begin{aligned}f(n)&=\sum_{k\leq n} \cos\left(\frac{2k\pi }{n}\right)\sum_{d|(k,n)}\mu(d)\\ &= \sum_{d\leq n}\sum_{k\leq n}\cos\left(\frac{2k\pi }{n}\right)\mu(d)\chi_{d|k}\chi_{d|n} \\ &= \sum_{d\leq n}\chi_{d|n}\mu(d)\left(\sum_{k\leq n}\cos\left(\frac{2k\pi }{n}\right)\chi_{d|k}\right) \\ &= \sum_{d\leq n}\chi_{d|n}\mu(d)\left(\sum_{i\leq \lfloor\frac{n}{d}\rfloor}\cos\left(\frac{2i\pi d }{n}\right)\right) \\&=\sum_{d|n}\mu(d) g(n/d)\end{aligned}$$
这里我们把最后那个和设置为一个新的算数函数$g$,$$g(x):=\sum_{i\leq \lfloor x\rfloor}\cos\left(\frac{2i\pi  }{x}\right)$$
当$x$是整数的时候，我们不难发现这个函数实际上就是Dirichlet卷积的单位函数$e(x)$.也即是说$$g(n)=\begin{cases}1& n=1\\ 0&\text{otherwise}\end{cases}$$
那么以上求和就可以归结为$$f=\mu*g=\mu*e=\mu$$
因此实际上上述和$f$就是Mobius miu函数。


---
tags:
  - math
  - 代数基础
  - sage
---

> [!问题1]
> 令$$S(j)=\sum_{\text{gcd}(n,2021)=1,n\leq 2021}n^j$$
> 求能过够使得$S(j)=0 \text{ mod }2021$的非负整数$j$

首先考虑到问题的代数属性，并且认为2021这个数字也并不具备什么特殊属性，不过是两个素数的乘积($2021=43\times 47$)那么把它转化为更为简洁的方式更有助于我们集中精力考虑其背后真正的本质。所以新的问题是:

> [!问题2：改造后的问题]
> 令$$S(j)=\sum_{n\in (\mathbb{Z}/m\mathbb{Z})^{\times}} n^j$$
> 求满足条件的非负整数$j$使得$S(j)=0_m$。其中$0_m$是环$\mathbb{Z}/m\mathbb{Z}$的加法单位元。其中$m=pq$,这是两个素数的乘积。

令$a\in (\mathbb{Z}/m\mathbb{Z})^{\times}$是环的乘法群当中的任意一个元素，那么由于$$S(j)=\sum_{n\in (\mathbb{Z}/m\mathbb{Z})^{\times}} (an)^j=a^j S(j)$$
因此在环上，得到$$(1_m-a^j)S(j)=0_m$$其中$1_m-a^j$是环$\mathbb{Z}/m\mathbb{Z}$当中的元素。

接下来我们需要从上面的方程中挖掘$S(j)=0_m$的信息，这自然就会涉及到环$\mathbb{Z}/m\mathbb{Z}$当中的基本性质问题。

首先一个简单的想法：有没有可能存在某个$j$使得方程中$1_m-a^j$是一个乘法单位元？毕竟环$\mathbb{Z}/m\mathbb{Z}$是一个有单位元的环(unital ring),那么如果$1_m-a^j$是乘法单位元，那么岂不是此时$S(j)=0_m$？然而这是做不到的，因为此时需要$a^j=0_m$，然而$a\in \mathbb{Z}/m\mathbb{Z}$,这显然没有这样的$j$存在。

接下来一个想法是，如果$1_m-a^j$可逆呢？因为如果是这样，我们就可以导出$S(j)=0_m$，因为我们可以左右两边乘以元素$(1_m-a^j)^{-1}$。



#### 1. 当$1_m-a^j$具有乘法逆元

即$1-a^j \in (\mathbb{Z}/m\mathbb{Z})^{\times}$,此时因为元素关于乘法可逆，于是导出$S(j)=0_m$。

> [!分而治之]
> 当我们要分析群/环当中某个元素的性质的时候，通常可以考虑把群/环分解为更小的群/环的乘积，这样可以更为具体地分析该元素在每个更小的群/环当中的性质，这样通常更为容易。这也算是代数当中的，“分而治之”的想法。


为了搞清楚此时的$j$的取值，我们分解此群，我们知道$$(\mathbb{Z}/pq\mathbb{Z})^{\times}\simeq (\mathbb{Z}/p\mathbb{Z})^{\times}\times (\mathbb{Z}/q\mathbb{Z})^{\times}$$
同时还应该注意到环的分解$$\mathbb{Z}/pq\mathbb{Z}\simeq \mathbb{Z}/p\mathbb{Z} \times \mathbb{Z}/q\mathbb{Z}$$那么问题翻译一下就是$1-a^j=(1_p-a_p^j,1_q-a_q^j)\in \mathbb{Z}/p\mathbb{Z} \times \mathbb{Z}/q\mathbb{Z}$其中$1_p,1_q$是分别是两个环的乘法单位元，$a_p,a_q$是分别两个群乘法群当中的一个元素。

为了使得上述式子成立，那么第一个分量应该$1_p-a_p^j \in (\mathbb{Z}/p\mathbb{Z})^{\times}$这件事在域$\mathbb{Z}/p\mathbb{Z}$当中是比较显然的，只要$1_p-a_p^j\neq 0_p$,这意味着只要$$j\not = 0 \text{ mod }p-1 $$第二个分量也是类似的结论，于是我们知道:$$1-a^j \in (\mathbb{Z}/m\mathbb{Z})^{\times}\implies j\not = 0 \text{ mod }p-1 \text{ and }j\not = 0 \text{ mod }q-1$$
此时一定有$S(j)=0_m$

接下来还需要考虑一个情况就是：
#### 2. 当$1_m-a^j$关于乘法不可逆

经过刚才的分析，这件事在此环当中只可能是，$1_p-a_p^j= 0_p$
或者$1_q-a_q^j= 0_q$。我们来分析这两种情况:
1. $1_p-a_p^j= 0_p,1_q-a_q^j\neq 0_q$:
假设$S(j)=(S(j)_p,S(j)_q)$为了满足$$(0_p,1_q-a_q^j)\cdot((S(j)_p,S(j)_q))=(0_p,0_q)$$那么必然需要$S(j)_q\neq 0_q$，因此这种情况不能让$S(j)=0_m$。
2. $1_p-a_p^j\neq 0_p,1_q-a_q^j= 0_q$:同上面一样的理由，并不能满足$S(j)=0_m$.
3. $1_p-a_p^j= 0_p,1_q-a_q^j= 0_q$:
此时，$j=0\text{ mod }(p-1)(q-1)$,此时当$n \in (\mathbb{Z}/m\mathbb{Z})^{\times}$的时候，假设$n^j=(n_p^j,n_q^j)$那么显然$$n^j=(1_p,1_q)=1_m$$于是考虑到$1_m$在$(\mathbb{Z}/m\mathbb{Z})^{+}$当中是pq阶元，因此$$\begin{aligned}S(j)&=\sum_{n\in (\mathbb{Z}/m\mathbb{Z})^{\times}} n^j\\ &= \sum_{n\in (\mathbb{Z}/m\mathbb{Z})^{\times}} 1_m \\ &= (p-1)(q-1)1_m \\ &\neq 0_m\end{aligned}$$
因此这种情况也不满足。

#### 3.结论

因此综上所述，$S(j)=0_m$当且仅当$$j\not = 0 \text{ mod }p-1 \text{ and }j\not = 0 \text{ mod }q-1$$
那么回到最初的问题上，$p=43,q=47$于是$j$需要满足不能被$42$且$46$整除。

这里我们可以稍微验证一下我们的结果(枚举):

```python
#虽然此代码语法上是python，但是需要再sagemath环境下运行
#否则例如euler_phi()这样的函数是不能直接调用的
# 定义m
m = 2021  # 你可以更改为需要验证的值

# 定义模m的乘法群
G = [n for n in range(1, m) if gcd(n, m) == 1]

# Euler's totient function
phi_m = euler_phi(m)

# 计算并验证从0到phi(m)的所有j
for j in range(phi_m + 1):
    S_j = sum([n^j for n in G]) % m
    #输出所有不为0的结果
    if S_j != 0:
        print(j)
```

我们会发现最后的结果就是所有被$p-1,q-1$整除的那些值，也就是说我们的计算是正确的。




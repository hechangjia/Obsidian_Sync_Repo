---
tags:
  - math
  - tool_idea
  - 数论
---

> [!把条件展开为求和]
> 当我们遇到形如$$\sum_{a,b;\text{cond}}f(a,b)
> =\sum_{a,b}f(a,b)\chi_{\text{cond}}(a,b)$$其中cond表示一个与$a,b$有关的一个条件。我们想到可以把$\chi_{\text{cond}}(a,b)$函数展开成一个求和的形式
> $$\chi_{\text{cond}}(a,b)=\sum_{c}g_c(a,b)$$这样展开以后，我们就得到一个双重求和:
> $$\begin{aligned}\sum_{a,b;\text{cond}}f(a,b) &=
> \sum_{a,b}f(a,b)\chi_{\text{cond}}(a,b) \\ &=
> \sum_{a,b}f(a,b)\sum_{c}g_c(a,b) =
> \sum_{a,b}\sum_{c}f(a,b)g_c(a,b) \\ &=
> \sum_{c}\sum_{a,b}f(a,b)g_c(a,b)\end{aligned}$$

### 1. 条件函数的Dirichlet卷积展开

> [!卷积法]
> 我们把被求和对象当中的一部分展开为Dirichlet卷积的形式,然后交换求和次序，从而试图把对该数论函数的估计变成对更为熟悉且简单的数论函数的估计。
#### 1.1 $N \times N$的方格里面有多少个互素的整数点

> [!问题1]
> $$S(N):=\frac{\#\{a,b\in\{1,...,N\}:(a,b)=1\}}{N^2}$$表示小于等于N的自然数对当中互素的对的密度，即互素的数对比上整体的比值。问题是，$S(N)$的渐近展开是怎样的?

1.  首先给此定义换一种求和的写法:$$S(N) =
    \frac{1}{N^2}\sum_{a,b\leq N;(a,b)=1}1$$
2.  利用上面的思路进行化简:假设$n =(a,b)$，我们注意到$n=1$这个判断函数可以改写为$\delta(n,1)$的形式，即$n=1$函数取值1，否则取值0。在算数函数当中，我们想到可以把这个东西展开为Dirichlet卷积和的形式。于是$$\delta(n,1) =\sum_{d|n}\mu(d)$$
于是上述求和可以转换为:$$\begin{aligned}S(N)
    &= \frac{1}{N^2}\sum_{a,b\leq N;(a,b)=1}1 \\ &=
    \frac{1}{N^2}\sum_{a,b\leq N}\delta((a,b),1)\\&=
    \frac{1}{N^2}\sum_{a,b\leq N}\sum_{d|(a,b)}\mu(d) \\
    &=\frac{1}{N^2}\sum_{a,b\leq N}\sum_{d\leq
    N}\mu(d)\mathbf{1}_{d|(a,b)}(d) \text{
    ,这一步对换序很重要}\\&=\frac{1}{N^2}\sum_{d\leq
    N}\sum_{a,b\leq N}\mu(d)\mathbf{1}_{d|(a,b)}(d)
    =\frac{1}{N^2}\sum_{d\leq N}\mu(d)\sum_{a,b\leq
    N}\mathbf{1}_{d|(a,b)}(d)\\&= \frac{1}{N^2}\sum_{d\leq
    N}\mu(d)\sum_{a,b\leq N;d|(a,b)}1 \text{
    ,这个求和是否比原来的求和更简单?这很重要}\\ &=
    \frac{1}{N^2}\sum_{d\leq N}\mu(d)
    \left(\frac{N}{d}+O(1)\right)^2 \\&= \sum_{d\leq
    N}\frac{\mu(d)}{d^2}+O\left(\frac{1}{N}\sum_{d\leq N}
    \frac{1}{d}\right)\\&= \sum_{d\leq N}\frac{\mu(d)}{d^2} +
    O\left(\frac{\log(N)}{N}\right)\end{aligned}$$
这里$\sum_{a,b\leq N;d|(a,b)}1=\left(\frac{N}{d}+O(1)\right)^2$是因为，我们把求和下标的条件变成了，$a,b,d\leq N \text{ and } d|a \text{ and }d|b$那么原先的求和就可以改成$$\begin{aligned}\sum_{a,b,d\leq N} \mathbf{1}_{d|a}\mathbf{1}_{d|b}&=\left(\sum_{a,d\leq N}\mathbf{1}_{d|a}\right)\left(\sum_{b,d\leq N}\mathbf{1}_{d|a}\right) \\ &= \left(\sum_{a,d\leq N}\mathbf{1}_{d|a}\right)^2 \\ &= \left(\frac{N}{d}+O(1)\right)^2\end{aligned}$$
3.  最后一步，我们可以通过一个已知的结果：$$\sum_{d\leq
    N}\frac{\mu(d)}{d^2} =
    \frac{6}{\pi^2}+O(1/N)$$
所以最后可以得到结论:$$S(N) =
    \frac{6}{\pi^2}+O\left(\frac{\log(N)}{N}\right)$$
这里[[简化一个数论求和]]是另外一个非常类似的问题，二者在技术层面上几乎别无二致。


#### 1.2 前$N$个自然数当中，square-free的自然数的占比是多少?

定义一个函数，$g(n):= \begin{cases}1&\text{n is square-free}\\0&\text{otherwise}\end{cases}$,那么我们要算的结果用求和表达就是:
$$S(N)=\frac{1}{N}\sum_{n\leq N}g(n)$$

然后我们实际上可以把这个判断是否为square-free的函数表达为一个新的求和:
$$g(n) = \sum_{ d^2|n} \mu(d)$$
所以按照上面的思路，我们现在可以尝试化简求和
$$\begin{aligned}S(N)&=\frac{1}{N}\sum_{n\leq N}\sum_{d^2|n}
\mu(d) \\ &= \frac{1}{N}\sum_{n\leq N} \sum_{d\leq N}
\mu(d)\chi_{d^2|n}(d) \\&= \frac{1}{N}\sum_{d\leq
N}\mu(d)\sum_{n\leq N}\chi_{d^2|n}(d) \\ &=
\frac{1}{N}\sum_{d\leq
N}\mu(d)\left\lfloor\frac{N}{d^2}\right\rfloor
=\frac{1}{N}\sum_{d\leq
\sqrt{N}}\mu(d)\left\lfloor\frac{N}{d^2}\right\rfloor \\&=
\sum_{d\leq
\sqrt{N}}\frac{\mu(d)}{d^2}+O\left(\frac{1}{N}\sum_{d\leq
\sqrt{N}}1\right) \\ &=
\frac{6}{\pi^2}+O\left(\frac{1}{\sqrt{N}}\right)\end{aligned}$$
按照概率数论当中的语言来表述这个问题就是，所有square-free的自然数这个集合对应的natrual density 或者asmyptotic density是多少? 按照该问题的结论，我们知道其natrual density是$\frac{1}{\zeta(2)}=\frac{6}{\pi^2}$.

-   **关于$|\mu|$的补充**:
上面的证明当中有一个地方用到了$g(n) =\sum_{ d^2|n} \mu(d)$,实际上这就是$|\mu(n)|$.

### 2. 把条件函数做傅里叶展开

### 2.1 roots of unity filter

这个方法也是处理求和的一个技巧，不过在当前的框架之下。因为它不过是对一种特定的条件
$$\mathbf{1}_{k|n}:=\begin{cases}1&k|n\\0&\text{otherwise}\end{cases}$$
的一种求和的表达方式而已。其本质是将函数在群$\mathbb{Z}/k\mathbb{Z}$上的傅里叶展开。详细参见，[[利用roots of unity filter求和]].




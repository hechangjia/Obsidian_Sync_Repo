---
tags:
  - math
  - 组合学
---
> [!主要的问题]
> 丢番图方程$$x+ 2y+3z = n$$非负整数解的个数是多少?

### 生成函数的做法:
假设该问题当中涉及的非负整数解的个数为$A_n$，然后通过整体地考虑生成函数
$$F(z) =
A_0+A_1z+...A_nz^n+...$$的性质，然后再搞清楚其中每个系数的值。这种做法是通用的，比如在下面的问题当中我们同样可以用类似的做法:
### 1. 一个类似但是更简单的问题

> [!问题]
> 求$$x_1+...+x_m =
>     n$$这个丢番图方程的非负整数解的个数。

在这个问题当中我们可以考虑生成函数$$G(z)=\prod_{k=1}^{m}(1+z+z^2+....) =
    \frac{1}{(1-z)^{m}}$$而这个函数的生成函数的第n阶项的系数就是非负整数解的个数。为什么呢?因为我们可以考虑一个组合的模型：假设我们重复$m$次有放回的从自然数集合(含0)$\mathbb{N}$当中选取一个元素，m次选取结束以后计算总和，最后问总和为n的选取的方式有多少?而这里面的每一次选取体现在$(1+z+z^2+....)$当中就是选取一个项目$z^k$，这就等价于选取了元素$k$，最后计算丢番图方程非负整数解的时候实际上就是对$\prod_{k=1}^{m}(1+z+z^2+....)$的展开形式合并同类项的时候，这时候$n$解项的系数自然就是非负整数解的个数。这里计算系数可以考虑Cauchy积分公式，也可以考虑直接求生成函数的$n$阶导数公式，不过二者殊途同归，因为计算留数也同样需要知道生成函数的高阶导数公式。于是非负整数解就是:$$G^{(n)}(0)/n!
    = \frac{m(m+1)...(m+n-1)}{n!} = \binom{n+m-1}{n}
    $$于是我们知道$$\frac{1}{(1-z)^{m}} = \sum_{n\geq 0}
    \binom{n+m-1}{m-1} z^n$$
### 2. 在此问题中用类似的生成函数的想法
**此问题可以理解为刚才那个问题的更复杂一些的形式**。因为此问题当中，我们每次选取之后计算总和的时候每一次选取的结果所占的权重是不同的。

如果我们把$x+2y+3z$理解为$x_1+x_2+x_3$的话，我们发现$x_2 \in \{0,2,4,...\}$以及$x_3 \in \{0,3,6,9,...\}$因此我们同样是差不多的三次选择，但是第二次选择和第三次选择是有条件的，即:
$$F(z) =(1+z+...)(\chi_1(0)+\chi_1(1)z^1+\chi_1(2)z^2+...)(\chi_2(0)+\chi_2(1)z^1+\chi_2(2)z^2+...)$$
其中$\chi_1(k)$是用来判断是否是偶数的判断函数，或者叫做非偶数的过滤器，同样的$\chi_2(k)$是3的倍数判断函数。

在这样的设置下，这些乘积展开是什么样子？假设问题中$x+2y+3z=n$的解的非负整数解的个数为$A_n$，那么乘积展开后会形如$$\begin{aligned}F(z)&=\sum_{n\geq 0}\left(\sum_{x_1+x_2+x_3= n }1\cdot \chi_1(x_2)\chi_2(x_3)\right)z^{n}\\ &= \sum_{n\geq 0}A_nz^n\end{aligned}$$这样其实我们便筛选出来了那些形如$x+2y+3z$的指数，因为要想
于是现在的生成函数变成了:$$\begin{aligned}F(z)&=(1+z+...)(1+z^2+z^4+...)(1+z^3+z^6+...)\\
    &= \frac{1}{(1-z)(1-z^2)(1-z^3)} \end{aligned}$$
 对于上面的**有理函数的幂级数展开的系数**，我们的确可以通过Taylor定理去考虑高阶导数公式，但是这样的有理函数毕竟不像$\frac{1}{(1-z)^{m}}$这个函数这样好求导。我们可以考虑另一种更方便计算的形式，首先可以把有理函数拆分为更简单的形式:$$\frac{1}{(1-z)(1-z^2)(1-z^3)}
    =
    \frac{1}{6}\frac{1}{(1-z)^3}+\frac{1}{4}\frac{1}{(1-z)^2}+\frac{17}{72}\frac{1}{(1-z)}+\frac{1}{8}\frac{1}{(1+z)}+\frac{1}{9}\frac{2+z}{1+z+z^2}$$通过上面第一个问题我们已经知道$\frac{1}{(1-z)^{m}}$的展开系数，于是剩下唯一的问题便是展开$\frac{1}{9}\frac{2+z}{1+z+z^2}$.这里之所以不能继续分解是因为我们上面只是考虑在$\mathbb{R}$当中的分解，其实我们还可以继续考虑在$\mathbb{C}$当中的分解，$$\frac{1}{9}\frac{2+z}{1+z+z^2}
    =
    (\frac{1}{18}+\frac{1}{6\sqrt{3}}i)\frac{1}{z+w}+(\frac{1}{18}-\frac{1}{6\sqrt{3}}i)\frac{1}{z-w^2}
    ,w=
    e^{\frac{\pi}{3}i}=\frac{1}{2}+\frac{\sqrt{3}}{2}i$$如此一来所有部分我们都可以分别展开，最后整合在一起即可:$$\frac{1}{6}\binom{n+2}{n}+\frac{1}{4}\binom{n+1}{n}+\frac{17}{72}+\frac{(-1)^n}{8}+(\frac{1}{18}+\frac{1}{6\sqrt{3}}i)\frac{(-1)^n}{w^{n+1}}-(\frac{1}{18}-\frac{1}{6\sqrt{3}}i)\frac{1}{w^{2n+2}}$$经过进一步化简，$A_n$即丢番图方程$x+2y+3z =n$的解可以写作:
    $$A_n=\frac{1}{72}\left(47+9(-1)^n+6n(6+n)+16\cos(2n\pi/3\right)$$
### 3. 正整数解的个数
使用**生成函数的做法求正整数解的个数**:

假设我们用$B_n$表示$x+ 2y+3z =n$此方程的正整数解的个数，同样按照上面类似的想法我们需要找到一个生成函数$$F_1(z) =
B_0+B_1z+...B_nz^n+...$$类似的做法，我们要给每一次选取附带条件，只不过现在条件变得更复杂了，比如第二次选择的时候除了要求是2的倍数，还要要求不能选到0.因此我们这里需要有两个新的过滤器，$\chi_1'(k)$用于过滤掉非2的倍数以及0，同样 $\chi_2'(k)$用于过滤掉非3的倍数以及0.于是
$$\begin{aligned}F_1(z) &=
(1+z+...)(\chi_1'(0)+\chi_1'(1)z^1+\chi_1'(2)z^2+...)(\chi_2'(0)+\chi_2'(1)z^1+\chi_2'(2)z^2+...)
\\ &=\frac{z^6}{(1-z)(1-z^2)(1-z^3)}
\end{aligned}$$所以非常巧的是，实际上
$$B_n =
A_{n-6}$$这实际上很容易思考，我们可以考虑一个等价的问题，$x+ 2y+3z =n$的正整数解的个数，恰好是$(x+1)+ 2(y+1)+3(z+1) =n$的非负整数解的个数。

* [[整数格点与一个带取整函数的和的极限问题]]当中我们涉及到另一个类型的线性丢番图方程整数解个数的问题。计算$$p_{k,n}(m):=\#\{(x,y)\in \{1,...,n\}\times\{1,...,2n\}:2x+y= m\}$$不同于上面的问题，这里对解做出了范围的约束。不过我们依旧可以用生成函数解决问题$$\begin{aligned}G(z):&=(z^2+\cdots+z^{2n})(z+z^2\cdots+z^{2n})\\&= z^3\frac{(1-z^{2n})^2}{(1-z)(1-z^2)}\\&=(z^3-2z^{2n+3}+z^{4n+3})\sum_{m\geq 0}A_mz^{m}\end{aligned}$$
由此我们总结出：

> [!想法]
> 总之，对变量的要求我们都可以转换为对生成函数系数的要求，从而构造出满足要求的生成函数。

### 4.在华林问题(Waning's problem)当中我们可以继续使用这样的过滤器的想法

问丢番图方程
$$x_1^k+x_2^k+...+x_s^k=n$$



的正整数解的个数$R_{s,k}(n)$。实际上Hardy,Littlewood以及Ramanujin在1918年的时候他们的想法的开头就是基于这样上面类似的想法，即我们要找到$R_{s,k}(n)$的生成函数：
$$G_{s,k}(z)=R_{s,k}(1)z+R_{s,k}(2)z^2+...$$那么同样的我能可以认为这是s次从自然数集合当中的选取，不过我们需要一个过滤器。每一次选取都使用同样的过滤器，即判断选取对象是否为正，以及是否是某个正整数的k次方。于是:
$$G_{s,k}(z) = \left(\sum_{m\geq
1}z^{m^k}\right)^s$$而对此生成函数的系数进行渐进分析就是Hardy-Littlewood-Ramanujin的Circle
method要解决的问题。

### 5.根据这个办法如何使用计算机快速得到结果
-   对于类似的问题如果$n$是具体的，数字并不算夸张，并且我想要立刻知道结果而不想花很多时间去推导一个具体的公式的话:



可以求助于Mathematica：
1.  还是要把生成函数给出来。
2.  使用SeriesCoefficient函数可以直接求出具体的生成函数的某一项。
```
SeriesCoefficient[
 1/((1 - z)*(1 - z^5)*(1 - z^10)*(1 - z^20)*(1 - z^50)), {z, 0, 111}]
```
3.  比如丢番图方程:$$x+5y+10z+20u+50v=111$$这个问题有一个非常现实的问题，就是说如果一个人有$111$块钱换成零钱，有多少种办法?我们可以立刻使用命令: 得到结果，一共有$452$种办法。如果要具体找出某一种解法，那么可以求助于Solve函数。
4.  如果是每个变量的选择范围是有限的，比如$$x_1+x_2+2x_3+5x_4+10x_5+10x_6+20x_7+50x_8=n$$其中限定$x_i\in\{0,1\}$。当然我们一样可以通过生成函数的系数得到，不过因为$0\leq n\leq99$于是我们完全可以一次性把生成函数的所有非0系数全部提取出来：
```
CoefficientList[(1 +
    z)^2*(1 + z^2)*(1 + z^5)*(1 + z^10)^2*(1 + z^20)*(1 +
    z^50) // Expand, z]

```



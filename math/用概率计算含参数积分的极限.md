---
tags:
  - math
  - tool_idea
---
### 1.基本的思路

> [!问题]
> 函数$f_n(x_1,...,x_n)$的含参数多重积分定义的极限:
> $$I_n:=\frac{1}{(b-a)^n}\int_{[a,b]^n}f_n(x_1,...,x_n)\,dm(x_1)\cdots dm(x_n)$$然后求$$\lim_{n\to \infty} I_n$$其中$m$是实数上的Lebesgue测度。

#### 1.1 转换为求随机变量的期望的极限

我们可以把上述问题视为是:

> [!转换为概率问题]
> 考虑概率空间$(\Omega,\mathcal{B},P)$以及此空间上**任意**一列独立同均匀分布的随机变量$X_1,...,X_n \sim U(a,b)$。$f_n$是Borel可测的函数，求期望$$I_n = E(f_n(X_1,...,X_n))$$的极限。

这两个问题等价的理由是，$$\begin{aligned}I_n &= E(f_n(X_1,...,X_n)) \\ &= \int_{\Omega}f_n(X_1(\omega),...,X_n(\omega))\,dP(\omega)\\ &= \int_{\mathbb{R}^n}f_n(x_1,...,x_n) \,dP_{X_1,...,X_n}(x_1,...,x_n) \\ &= \int_{[a,b]^n} f_n(x_1,...,x_n)  \frac{1}{(b-a)^n}dm(x_1)\cdots dm(x_n)\end{aligned}$$
1. **新的随机变量**：
这里$Y_n(\omega):=f_n(X_1,...,X_n)$要成为一个新的随机变量的话需要对映射$f_n$有一定的要求，通常会要求是Borel可测的，因为Borel可测的复合还是Borel可测。
2. **新的随机变量的分布**
$P_{X_1,...,X_n}$是随机变量$X_1,...,X_n$的联合概率分布测度，是由映射$$T(\omega):=(X_1(\omega),...,X_n(\omega))$$一个从$\Omega\to \mathbb{R}^n$的Borel可测映射。此时随机变量序列的联合分布是一个由$T$给出的$\mathbb{R}^n$上的像测度，$$P_{X_1,...,X_n}(A):=P(T^{-1}(A))$$对任意$A \in \mathcal{B}(\mathbb{R}^n)$成立。

这样做的理由是，因为$$Y_n(\omega):=f_n(X_1,...,X_n) = f_n\circ T(\omega)$$
那么对$Y_n$关于测度$P$求积分，根据[[Weierstrass逼近定理的概率途径证明]]中1.6给出的积分换元公式，我们知道$$\int_{\Omega} f_n\circ T \, dP = \int_{\mathbb{R}^n} f_n\,d(T_{*}P)=\int_{\mathbb{R}^n} f_n\,d(P_{X_1,...,X_n})$$
又因为独立性，以及同分布性，假设$A=A_1\times\cdots \times A_n$我们可以得到$$\begin{aligned}P_{X_1,...,X_n}(A)&=P_{X_1}(A_1)\cdots P_{X_1}(A_n)\\&= P((X_1,...,X_n)\in A)\\&=P\left(\bigcap_{k\leq n}\{X_k(\omega)\in A_k\}\right)\\ &=\prod_{k\leq n}P(X_k\in A)\\ &=  \frac{1}{(b-a)^n}m(A_1)\cdots m(A_n)\end{aligned}$$


#### 1.2 构造新的随机变量

如果$Y_n=f_n(X_1,...,X_n)$本身是一个分布较为简单，期望好算的对象，那么我们甚至可以直接得到$I_n$的表达式，然后对该表达式求极限即可。

* [[n个均匀分布随机变量的最大分布的期望]]这就属于是这类问题。此时$$f_n(X_1,...,X_n) = \max\{X_1,...,X_n\}$$而后者的分布并不算复杂，因此可以直接考虑求出其密度然后计算积分。

但是也有大量求出期望表达式是困难的，此时就要考虑随机变量的极限分布的行为。通常我们希望，把$f_n(X_1,...,X_n)$转换为$$g\circ Y_n$$的这种复合，此时的$g$是一个不含参数的映射。然后我们集中精力处理$Y_n$的收敛性质.特别是当$g$是一个连续函数的时候，其可以保持$Y_n$的收敛性质。具体来说，对于随机变量而言，连续函数可以保持其依分布收敛，依测度收敛(证明参考[[有限测度空间上依测度收敛的等价命题]])，以及几乎处处收敛。

### 1.例子1 


> [!问题]
> 求$I(n)$的极限(n>1)，其中$I(n)$定义为:
> $$I(n):=\int_{[0,1]^n} \frac{1}{1-\prod_{i=1}^{n}x_i}dx_1...dx_n$$

#### 1.1 准备工作
我们把积分视为随机变量
$$f_n(X_1,...,X_n):=\frac{1}{1-\prod_{i=1}^n X_i}$$
的期望，其中$X_1,...,X_n \sim U(0,1)$是独立均匀分布的随机变量。
#### 1.2 利用随机变量的收敛结果
一个基本的想法，如果这个随机变量可以转换为求和的形式，那么就可以利用大数定律取做一些事情了。于是
$$\begin{aligned} \frac{1}{1-\prod_{i=1}^n X_i}  &= \frac{1}{1-\exp\left(\sum_{i=1}^n\log(X_i)\right)}\\ &=\frac{1}{1-\exp\left(-nY_n\right)} \end{aligned}$$
其中$Y_n = \frac{1}{n}\sum_{i=1}^{n}(-\log(X_i))$。那么整个问题就变成了考虑$E(g(nY_n))$的极限问题,其中$g(x):=\frac{1}{1-\exp(-x)}$.

这样设计的主要缘故是，当$X_i \sim U(0,1)$的时候$-\log(X_i) \sim \text{Exp}(1)$,此时我们知道$E(-\log(X_1)) = 1$是存在的，那么由弱大数定律可以知道，$$Y_n\xrightarrow{P}E(X_1)$$这蕴含着$nY_n \xrightarrow{P}{+\infty}$,同时$\lim_{x\to \infty}g(x)=1$是存在的，那么根据[[有限测度空间上依测度收敛的等价命题]]当中证明的关于随机变量依概率收敛在连续函数的作用下保持不变的特性，
$$g(nY_n)\xrightarrow{P} g(+\infty)=1 $$

最后期望的收敛需要结合两条有用的结果

> [!依概率收敛的Fatou引理]
> 假设随机变量$X_n \geq 0$,如果$X_n \xrightarrow{P}{X}$那么$$\liminf_{n\to \infty} E(X_n) \geq E(X)$$

> [!依测度收敛的单调收敛定理]
> 假设随机变量$X_n \geq 0$,并且随机变量序列几乎处处单调,如果$X_n \xrightarrow{P}{X}$那么:$$E(X_n)\to E(X)$$

> [!依概率收敛的控制收敛定理]
> 随机变量$X_n \xrightarrow{P}{X}$,并且满足下面两个条件当中的一个:
> 1. $|X_n| \leq Y$,并且$Y$可积，即$E(Y)<\infty$.
> 2. 存在非负连续函数$g(x)$,并且$|x|\to \infty$的时候$|x|/g(x)\to 0$并且使得$E(g(X_n))$一致有界。
> 
> 则可以下结论：$$E(X_n)\to E(X)$$

这里我们选择利用**单调收敛定理**，因为我们意识到$Z_n =g(nY_n)$非负，单调减少的随机变量序列。原因是因为，$nY_n = \sum_{i=1}^{n}(-\log(X_i))$是单调增加的，因为$-\log(X_i(\omega))$是非负的。然后由于函数$g$是单调减少的函数，于是$Z_n$也是一个单调减少的随机变量序列。于是$$E(Z_n)\to E(1)=1$$
于是积分$$I_n \to 1$$
这个问题还可以通过展开然后交换次序的办法先得到含参数积分的表达式，最后对表达式$I_n$来考虑极限。参见[[zeta函数整数值的积分表示]].


## 2.例子2，类似的一个问题

> [!问题2]
> $$J_n = \int_{[0,1]^n}\sin(\sqrt[n]{x_1...x_n})dx_1...dx_n$$
> 求$J_n$的极限。

采用和上面类似的策略，定义一个新的随机变量为
$$\begin{aligned}\sin\left(\sqrt[n]{X_1...X_n}\right)&= \sin(\exp(-Y_n))\end{aligned}$$
其中$Y_n = \frac{1}{n}\sum_{i=1}^{n}(-\log(X_i))$.于是此处令$g(x):=\sin(\exp(-x))$,
根据弱大数定律$$Y_n\xrightarrow{\text{ P }}E(-\log(X_1)) =1$$
这里实际上$-\log(X_1)\sim \text{Exp}(1)$.

而依据[[有限测度空间上依测度收敛的等价命题]]当中的关于连续函数的命题，
于是$$g(Y_n) \xrightarrow{P} g(1)$$
最后因为此连续函数是有界的，那么**由依测度收敛的控制收敛定理**，我们可以得到

$$E(g(Y_n))\to E(g(1))=\sin(1/e)$$
于是积分的极限就是：
$$J_n\to \sin(1/e)$$

## 3. 例子3，一类经常出现的例子

> [!问题]
> 求含参数积分的极限(关于参数n):
> $$I_n(p,q) = \int_{[0,1]^n}\frac{x_1^q+...+x_n^q}{x_1^p+...+x_n^p}dx_1...dx_n$$
> 其中$p,q \in \mathbb{Z}$

对于该问题我们可以先针对不同的$p,q$猜出结论，然后去证明这样的结果:

```wolfram
randomIntegrate[p_, q_, n_] := Block[{seed, De, Nu},
  Mean@Table[
    (*seed就是每次生成n个独立同均匀分布的随机变量的随机数*)
    seed = RandomVariate[UniformDistribution[{0, 1}], n];
    (*重复生成10次以求平均值*)
    (*这里计算分子除以分母的值*)
    Total[#^q & /@ seed]/Total[#^p & /@ seed], {k, 1, 10}]
  ]
```
根据以上的随机模拟，我们提出如图所示的猜想。其中横坐标表示$q$,纵坐标表示$p$:
![[含参数积分极限示意图.png]]
具体来说便是:
1. $q> -1,p> -1$（图中右上角）,我们可以得到结论：
$$I_n(p,q)\to \frac{1+p}{1+q}$$
2. $q>p,p\leq  -1$的时候（图中右下角），可以得到结论: 
$$I_n(p,q)\to 0$$
3. $p=q$的时候(图中的那条直线)，情况是平凡的：$$I_n(p,q) =1$$
4. $q<p,q\leq -1$(图中左上角)，可以得到结论:$$I_n(p,q)\to +\infty$$
接下来除了平凡的情况以外，我们分别讨论其中三种情况。
#### 3.1 $q> -1,p> -1$图中右上角的情况

先考虑$Y_{n,\alpha}=\frac{1}{n}(X_1^{\alpha}+...+X_n^{\alpha})$这里先考虑随机变量$X^{\alpha}$的密度函数:
1. 当$\alpha<0$的时候，概率密度函数为$$f_{X^{\alpha}}(t)=-\frac{1}{\alpha}t^{1/\alpha-1},t\geq 1$$当$t<1$的时候密度函数为0.
此时$$E(X^{\alpha})=\int_{1}^{+\infty} tf_{X^{\alpha}}(t) \,dt=\int_{1}^{+\infty} -\frac{1}{\alpha}t^{1/\alpha}\,dt$$
于是我们便可知道，如果$\alpha>-1$那么这种情况下期望是存在的，且等于$\frac{1}{1+\alpha}$.但是如果$\alpha\leq -1$那么期望是不存在的。
2. 当$\alpha>0$
的时候，概率密度函数为$$f_{X^{\alpha}}(t)=\frac{1}{\alpha}t^{1/\alpha-1},t\in (0,1)$$否则在此区间外，密度函数为0.

此时因为随机变量的值域为$(0,1)$因此$$E(X^{\alpha})=\int_{0}^{1} tf_{X^{\alpha}}(t) \,dt=\int_{0}^{1} \frac{1}{\alpha}t^{1/\alpha}\,dt$$此时期望显然存在，且等于$\frac{1}{1+\alpha}$.


根据上面几种情况我们知道，在$p>-1,q> -1$的情况下，我们可以**保证分子分母期望的存在性**。根据弱大数定律，
1. $Y_{n,q}\xrightarrow{P}{\frac{1}{1+q}}$
2. $Y_{n,p}\xrightarrow{P}{\frac{1}{1+p}}$
因此$$\frac{Y_{n,q}}{Y_{n,p}}\xrightarrow{P}{\frac{1+p}{1+q}}$$这里可以考虑依概率收敛的**单调收敛定理**,运用简单的分式的不等式，我们可以知道$\frac{Y_{n,q}}{Y_{n,p}} \geq \frac{Y_{n+1,q}}{Y_{n+1,p}}$于是函数列是非负且单调减少的，那么
$$E\left(\frac{Y_{n,q}}{Y_{n,p}}\right) \to \frac{1+p}{1+q}$$
#### 3.2 $q>p,p\leq  -1$图中右下角的情况

这类情况当中，如果$q>-1$那么问题和上面其实并没有两样。回忆例子1当中的处理方式，我们知道此时$Y_{n,p}\xrightarrow{P}{+\infty}$,因此



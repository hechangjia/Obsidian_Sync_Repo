---
tags:
  - math
  - 实分析
  - 考研
---

> [!复旦大学考研题目]
> $a_1=2024$,并且对任意正整数n序列满足递推关系$$a_{n+1}=a_{n}+\frac{2}{a_n}$$求$$\lim_{n\to \infty}\frac{a_n}{\sqrt{n}}$$

首先可以直接观察到序列是单调增加的，因为$$a_{n+1}-a_n=\frac{2}{a_n}>0$$
那么继而会想到考虑

> [!问题1]
> $a_n$是否有界?

因为如果有界那么问题就非常简单，因为$\frac{a_n}{\sqrt{n}}=O(n^{-1/2})$那么极限必然是0.如果此序列无界，那么自然需要进一步的讨论。

> [!lemma1]
> $a_n$无界。

参考[[序列差分的部分和与Riesz-Fischer定理]]当中的想法，我们可以把一个序列本身表示为其差分的和。而问题中的序列给出了差分的一个关系，相当于告诉我们$$\Delta a_n = \frac{2}{a_n}$$那么$$\begin{aligned}a_N&=a_1+\sum_{1\leq n\leq N-1}\Delta a_n\\ &= a_1+\sum_{1\leq n\leq N-1}\frac{2}{a_n}\end{aligned}$$那么如果对于任意正整数n序列都有一个上界$M$那么$$a_N>a_1+2\frac{N-1}{M}$$这就导致$a_N$实际上是无界的这样一个矛盾。

接下来我们需要估计$\frac{a_n}{\sqrt{n}}$。

这里有几种不同的路径，但基本基于两种利用差分的想法：

> [!想法]
> 假设序列$$b_{n+1}=b_n+f(b_n)$$那么如果：
> 1. $S_N=\sum_{n\leq N}f(b_n)$的渐近展开我们是知道的，那么借由差分和与序列本身的关系，我们也能得到$b_N$的渐近展开。
> 2. 如果我们已知需要估计$b_n$渐近展开的形如$g(n)$这一项的系数，并且同时知道$\lim_{n\to \infty}\frac{f(b_n)}{g(n+1)-g(n)}=a$存在并且等于某个已知的结果，那么由Ostolz定理，那么$$\frac{b_n}{g(n)}\to a$$

类似的思路的例子：
1. [[利用Stolz定理确定递归序列的渐近系数]]
2. [[利用Stolz定理确定递归序列的渐近系数2]]

### 1. 如果注意到此序列而言的一个特殊结构

注意到此序列的一个特殊结构：
$$a_{n+1}^2=a_n^2+4+\frac{4}{a_n^2}$$
那么如果此时考虑$b_n:=\frac{a_n^2}{n}$利用O.Stolz定理，由于
$$a_{n+1}^2-a_n^2=4+\frac{4}{a_n^2}\to 4$$那么$$b_n=\frac{a_{n+1}^2-a_n^2}{n+1-n}\to 4$$
于是$$\frac{a_n}{\sqrt{n}}\to 2$$
### 2. 如果没有注意到这个特殊的结构

这里约定，$f(x)\gg g(x),g(x)>0$表示存在$M$以及$x_0$使得任意$x>x_0$都有$$|f(x)|>Mg(x)$$同理$f(x)\ll g(x)$表示存在$M$以及$x_0$使得任意$x>x_0$都有$$|f(x)|<Mg(x)$$
以及$f(x)\asymp g(x)$表示，同时成立$f(x)\gg g(x)$以及$f(x)\ll g(x)$.

于是利用差分的与序列自身的关系:

首先假设$a_N \gg \sqrt{N}$,那么$\frac{1}{a_n}\ll \frac{1}{\sqrt{n}}$,于是由[[自然数的r次幂的部分和估计]]当中的结果(当然这里远远用不到那么精确，直接Euler-Maclaurin方法然后忽略渐近展开的常数项即可)，$$\begin{aligned}a_N &= a_1+2\sum_{1\leq n\leq N-1}\frac{1}{a_n}\\&\ll 2\sum_{1\leq n\leq N-1}\frac{1}{\sqrt{n}}\ll\sqrt{N}\end{aligned}$$
这表明$$a_N \asymp \sqrt{N}$$
既然如此我们可以假设$a_n = a\sqrt{n}+o(\sqrt{n})$,然后继续利用上面的关系式,得到：$$\begin{aligned}a_N &= a_1+2\sum_{1\leq n\leq N-1}\frac{1}{a_n}\\&=a_1+ 2\sum_{1\leq n\leq N-1}\frac{1}{a\sqrt{n}+o(\sqrt{n})}\\&= \frac{2}{a}\sum_{1\leq n\leq N-1}\frac{1}{\sqrt{n}}+o\left(\sum_{1\leq n\leq N-1}\frac{1}{\sqrt{n}}\right)\\&= \frac{2}{a}\left(\zeta(1/2)+2\sqrt{N}+O(N^{-1/2})\right)+o(\sqrt{N})\\&= \frac{4}{a}\sqrt{N}+ o(\sqrt{N})\end{aligned}$$
对比前面的假设，就不难得到关系$$a=\frac{4}{a}$$并且考虑到序列是正项序列，因此$a=2$.

### 3. 把两个思路合并起来

为了得到$a_N$的更精确的渐近展开，按照第一个思路的观察，我们可以先尝试对$a_N^2$进行渐近展开。按照这个关系:
$$a_{n+1}^2-a_n^2=4+\frac{4}{a_n^2}$$
我们可以利用差分和序列自身的关系，然后因为前面的结论我们知道$a_n^2 = 4n+o(n)$,于是$$a_{n+1}^2-a_n^2=4+\frac{1}{n}+o\left(\frac{1}{n}\right)$$
于是$$\begin{aligned}a_N^2&=a_1^2+\sum_{n\leq N-1}4+\frac{1}{n}+o(H_{N-1})\\&=a_1^2+4(N-1)+H_{N-1}+o(H_{N-1}) \\&= 4N+\log(N)+o(\log(N))\end{aligned}$$
于是$$\begin{aligned}a_N&=\sqrt{4N+\log(N)+o(\log(N))}\\&= 2\sqrt{N}\sqrt{1+\frac{\log(N)}{4N}+o\left(\frac{\log(N)}{4N}\right)}\\&= 2\sqrt{N}+\frac{\log(N)}{4\sqrt{N}}+o\left(\frac{\log(N)}{\sqrt{N}}\right)\end{aligned}$$







---
tags:
  - math
  - 解析数论
---

> [!Erdos关于pi函数的估计]
> $\pi(x)$是素数计数函数，表示不超过x的正整数当中有多少个素数。当$x\geq 2$时，此函数有上界和下界的估计:$$\left(\frac{3\log(2)}{8}\right) \frac{x}{\log(x)}<\pi(x)<(6\log2) \frac{x}{\log(x)}$$

这个结果相比于Chebyshev在19世纪给出的结果(C.的结果是上界系数1.1,下界系数0.92)，好在其证明简短且基本是初等的，但是其精度在一些情况下是远远不够的。比如想要利用$\pi(2x)-\pi(x)\geq 1$证明Bertrand Postulate，这个结果还不够精确，但是Chebyshev的结果就可以在$x\geq 8$的时候证明Bertrand Postulate。

目前为止最好的结果由Pierre Dusart在1998年给出：

> [!Pierre Dusart ,1998]
> $$\frac{x}{\log(x)}\left(1+\frac{1}{\log(x)}\right)<\pi(x)<\frac{x}{\log(x)}\left(1+\frac{1}{\log(x)}+\frac{2.51}{\log(x)^2}\right)$$
> 不等式的前半部分对于$x\geq 599$成立，后半部分对于$x\geq 355991$成立。

但是Erdos的思路倒是很值得我们去借鉴。整个证明的风格和[[Bertrand假设的证明]]是非常类似的，都是围绕着$$\binom{2n}{n}=\prod_{p<2n}p^{r_p(n)}$$其中$r_p(n)=\nu_p\left(\binom{2n}{n}\right)$表示p恰好整除$\binom{2n}{n}$的幂（或者素因子的最高次幂）。同时考虑到[[Bertrand假设的证明]]当中的lemma3,我们是可以对$p^{r_p(n)}$的上界给出一个估计的，而这个上界估计会涉及$pi(x)$这个函数的值。同时我们又可以通过二项式定理给出组合数的一个下界估计，那么我们就可以先得到一个关于$\pi(2n)$的下界估计。

### 1. 下界估计

参考[[Bertrand假设的证明]]当中差不多的讨论,特别是其中的lemma3，我们知道$$\frac{4^n}{2n+1}<\binom{2n}{n}=\prod_{p<2n}p^{r_p(n)}\leq (2n)^{\pi(2n)}$$
那么我们立刻可以得到关于$\pi(2n)$的一个下界估计，$$\pi(2n)>\left(\frac{\log(2)}{2}\right) \frac{2n}{\log(2n)}$$
现在面临的一个关键问题是，如何把函数在偶数上的估计转换为在全体实数上的估计?

这里我们把Erdos的处理方法给一般化：

> [!把偶数的下界估计转换为实数的下界估计]
> 假设$f(2n)\geq g(2n)$对任意正整数成立，并且$g,f$在$\mathbb{R}^{+}$上是单调增加的函数，那么在$x>8$的条件下有$$f(x)>g(3x/4)$$

因为对于任意的$2n\leq x<2n+2$的时候，反过来就有$x-2<2n$然后如果我们让$x>8$那么又有$2n>x-2\geq 3x/4$.于是如果我们利用单调性就有:$$f(x)\geq f(2n)\geq g(2n)>g(3x/4)$$
那么用到当前的情形下就是：
$$\pi(x)>\left(\frac{\log(2)}{2}\right) \frac{3x/4}{\log(3x/4)}>\left(\frac{3\log(2)}{8}\right)\frac{x}{\log(x)}$$
这便是下界的估计。

### 2.上界的估计

[[Bertrand假设的证明]]当中的lemma3有一个推论，因为$$r_p(n)=\lfloor\log_{p}(2n)\rfloor$$所以如果$3\leq n<p< 2n$,此时因为$$1+\frac{2}{\log(n)}>\frac{\log(2n)}{\log(p)}> 1$$那么一定有$r_p(n)=1$.这也就是说，对于组合数$\binom{2n}{n}$而言，但凡是$3\leq n<p\leq 2n$的素数，都整除这个组合数，并且指数为1.

这一点可以看一些具体的例子:
```wolfram
n = 12;
FactorInteger[Binomial[2*n, n]]
```
这个例子当中我们可以看到超过12的素数里面，13,17,19,23都是此组合数的素因子，指数都是1.

那么，我们可以得到$$\binom{2n}{n}=\prod_{p<2n}p^{r_p(n)}>\prod_{n<p<2n}p$$
右边如果继续做下界估计就会涉及$\pi(x)$,那么我们需要给左边找一个上界估计，这样就可以得到关于$\pi(x)$的上界估计了。一个显然，但是非常粗糙的上界是,$\binom{2n}{n}<(1+1)^{2n}$,于是$$4^n>\prod_{n<p<2n}p$$两边取对数得到$$2\log(2)n>\sum_{2n>p>n}\log(p)>(\pi(2n)-\pi(n))\log(n)$$
稍微变形一下得到，$$\pi(2n)\log(n)-\pi(n)\log(n/2)<2\log(2)n+\pi(n)\log(2)<3\log(2)n$$
这样配的缘故是我们可以凑出来一个形式$$f(n)-f(n/2)<g(n)$$
这种形式我们可以把关系变成关于$f(x)$的上界。

如果我们取$k=2^i$,$i=1,...,k-1,k$那么我们可以制造一个telescoping sum,$$f(2^i)-f(2^{i-1})<g(2^i)$$我们换个角度来说，事情就很明显了，如果$f(2^i)=\phi(i),g(2^i)=\varphi(i)$那么上面的关系就是$$\phi(i)-\phi(i-1)<\varphi(i)$$于是我们当然有:$$\phi(k)-\phi(0)<\sum_{1\leq i\le k}\varphi(i)$$于是转换回来就是(如果情况比较好，最后上界函数还是关于$2^k$的形式)$$f(2^k)<f(1)+\sum_{1\leq i\le k}g(2^i)=F(2^{k})$$
于是我们要如何把这个结果转换为实数的控制? 我们同样利用单调性完成这件事，就如同上面一样：$2^{k-1}<x\leq 2^{k}$然后，假设$f,F$都是单调增加的，于是:$$f(x)\leq f(2^{k})<F(2^{k})<F(2x)$$

---
在当前的问题下，最后我们通过$f(n)-f(n/2)<g(n)$得到的关系是:$$\pi(2^{k+1})<(6\log(2))\left(\frac{2^k}{\log(2^k)}\right)$$这样我们就可以用上面的想法达到最后的目的得到，当$x\geq 4$的时候有:

$$\pi(x)<(6\log2) \frac{x}{\log(x)}$$
只不过，当$x\in [2,4)$的时候可以直接验证这个式子是否成立。

### 3. 把整数值的离散的上界转换为实数的连续上界

把上面的两种情况整理一下可以得到想法:

> [!从离散上界到连续上界的想法]
> 1. 首先得到$f(a_n)\leq g(a_n)$，并且$f(x),g(x),a_n$都单调增加
> 2. 考虑$a_{n-1}<x\leq a_{n}$,于是由于单调性我们有$$f(x)\leq f(a_n)\leq g(a_n)$$
> 3. 现在想要把上界转换为实数的上界，就要利用$x$所在的区间。其实我们只需要考虑是否存在某个正实数$c$使得存在$N_c$当$n>N_c$的时候就有:$$a_n\leq ca_{n-1}<cx$$如果可以的话，我们就可以继续上面的不等式得到:$$f(x)\leq f(a_n)\leq g(a_n)<g(cx)$$
> 于是我们便得到了连续的上界。


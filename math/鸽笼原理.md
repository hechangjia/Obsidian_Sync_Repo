---
tags:
  - math
  - tool_idea
---
### 1. 有限的鸽笼原理
#### 1.1 原理的引入
这个原理名字的由来是根据一个简单的问题"假设我们有n+1只鸽子，以及n个鸽子笼，那么必然有两只鸽子住在同一个笼子里面。"类似的命题还有,

> [!问题]
> 北京市当中必然有两个人头发一样多。

这个问题很简单，世界上拥有最多头发的人，头发根数不会超过1000万根头发，而北京人口远不止1000万。

如果我们去数北京人每个人的头发的数量，实际上建立起来了一个$f:P\to H\subseteq \mathbb{N}$的映射，前者是北京人的集合，后者是自然数的子集表示所有可能的北京人头发的数量(包含0)，并且我们知道$|H|< 10^7$，因为不可能有北京人头发有超过一千万根.那么$$|P| >|H|$$于是这必然不会是单射，因此存在一个数$y_0 \in H$对应到两个以上的$P$当中的元素，这表明至少有两个人有一样数量的头发。

所以鸽笼原理的关键是

> [!鸽笼原理]
> 如果存在从有限集合$A\to B$的一个映射$f$，并且$|A|> |B|$，那么必然存在一个$y_0 \in B$使得其原像$f^{-1}(y_0)$这个集合当中少有两个非空元素。

本质是因为**如若不然**，那么由于$f$是$A\to f(A) \subseteq B$的满射，任何$y\in f(A)$其原像这个集合最多有一个元素，结合满射的条件，$\forall y \in f(A)$存在唯一一个(因为反证的假设)$x \in A$使得$f(x)=y$成立，于是这是$A\to f(A)$的双射。因此$|A|=|f(A)|\leq |B|$，然而这与条件$|A|>|B|$矛盾。



### 1.2 几个简单的例子

下面是一些具体的应用:

> [!例子1]
> $S$是n+1个整数的集合，证明存在两个$a,b\in S$使得他们的差$n|(a -b)$

在这个问题当中，因为涉及到被n整除，我们很自然想到考虑$\mathbb{Z}_n$，整数模n的剩余类构成的集合。这里我们可以把模掉整数n，视为一个映射:$$f:a \in S \mapsto \mathbf{a} \in \mathbb{Z}_n$$
而我们知道$|S| > |Z_n|$，因此必然存在某个$\mathbf{r} \in \mathbb{Z}_n$使得$f^{-1}(\mathbf{r})$此集合当中包含至少两个元素，假设这两个元素为$a,b$。这两个元素模n属于同一个剩余类，这意味着二者模n等价，即$n|(a -b)$.

---

做一个比喻的话，相当于这里我们的映射$f$是把集合$S$当中的整数"放"到模n的剩余类当中，因为鸽子多，笼子少因此必然有两只鸽子在同一个笼子当中。

如果把这个想法再复杂化一些，便有这样一个问题:

> [!例子2：曼哈顿奥赛2006]
> 集合$A$包含100个整数，证明集合$A$当中存在一个包含15个元素的子集，其中任意两个整数的差能被7整除。

使用刚才的经验，我们可以同样构造整数模7的映射$$g:a \in A \mapsto \mathbf{a} \in \mathbb{Z}_7$$
我们要证明的无非是，存在某个$\mathbf{r} \in \mathbb{Z}_7$使得$|g^{-1}(\mathbf{r})|\geq 15$,也就是说至少存在15个元素属于同一剩余类当中。

如若不然，这意味着每个剩余类对应的原像最多14个，然而$7 * 14 = 98$.但是$|g^{-1}(Z_7)|=100$.这意味着这个假设是错误的，存在一个剩余类其原像集合的数目超过14.

---
根据例子2的经验我们可以把有限的情况的鸽笼原理进一步细化为

### 1.3 有限鸽笼原理的推广

> [!鸽笼原理2]
> $f:A\to B$并且$A,B$均为有限集合，并且满足$|A| > k|B|$于是必然存在一个$y_0 \in B$使得$$|f^{-1}(y_0)| > k$$
> 如果记$|A| =n,|B| =m$那么也可以表述为存在一个$y_0 \in B$使得$$|f^{-1}(y_0)| \geq \lceil n/m\rceil$$

因为两个集合都是有限的，那么我们有$|A| = \sum_{y\in B}|f^{-1}(y)|$，假设不存在原理当中的结果，也就是说任何元素的原像当中最多k个元素，那么$$|A| = \sum_{y\in B}|f^{-1}(y)| \leq k|B|$$这与假设矛盾，因此命题成立。

---
根据这一条，那么例子2便显而易见，因为$100 > 14 * 7$因此必然有一个剩余类其原像当中至少有15个元素。

鸽笼原理的第二个版本还可以从概率的角度来进行解释，这也可以视为[[组合学中的概率方法：通过求期望证明具有某种性质的结构的存在性]]的其中一个运用。

如果我们把有限集合$B$给具体表达出来$B = \{y_1,...,y_m\}$，如果我们在此集合的基础上建立一个离散的概率空间$(B,\mathcal{F},P)$其中sigma代数为集合$B$的幂集(所有子集的集合)。任何$E \in \mathcal{F}$的概率测度为$P(E) = \frac{|E|}{m}$,此时的概率测度不过是单位化了的counting measure。

接下来考虑一个随机变量，即一个从$X:B\to \mathbb{R}$的Borel可测函数，定义为$$X(y):=|f^{-1}(y)|$$
也可以理解为此随机变量的值为某个$y \in B$的原像的集合的个数。然后我们计算此随机变量的期望，于是$$\begin{aligned}E(X)&=\int_{B}X(y) \,dP(y) \\ &= \frac{1}{m}\sum_{y\in B} X(y) \\ &=  \frac{1}{m}\sum_{y\in B} |f^{-1}(y)| \\ &= \frac{|A|}{m} = \frac{n}{m}\end{aligned}$$
那么因为随机变量的期望为$\frac{n}{m}$，那么必然存在某个$B$当中的元素$y_0$使得$$X(y_0):=|f^{-1}(y_0)| \geq  \frac{n}{m}$$(这一点参考[[组合学中的概率方法：通过求期望证明具有某种性质的结构的存在性]],其中一般的准则当中的第二条。)

而我们知道$X(y_0)$必定是整数，如果$\frac{n}{m}$是整数，那么$\frac{n}{m}=\lceil n/m\rceil$,如果不是整数，那么$X(y_0)$断然是不能与之相等的，于是$X(y_0)>\frac{n}{m}$那么自然大于等于$\lceil n/m\rceil$.那么最终我们可以下结论:

存在一个$y_0 \in B$使得$$|f^{-1}(y_0)| \geq \lceil n/m\rceil$$

#### 1.4更多的例子

下面看一些更多的应用:
1. [[Kronecker定理，Dirichlet定理及其应用]]在证明Dirichlet定理当中使用到了这个原理。在Dirichlet定理的证明过程中,我们可以把$(0,1)$等分为$n$份，分别是:$(0,\frac{1}{n}),[\frac{1}{n},\frac{2}{n}),...,[\frac{n-1}{n},1)$.然后我们从$E_{\alpha}$当中选取$n+1$个元素，比如前n+1个元素即$$\{1\alpha\},\{2\alpha\},...,\{(n+1)\alpha\}$$那么因为区间只有n个，那么必然有两个元素落在同一个区间当中，这意味着这两个元素的"距离"小于$\frac{1}{n}$.
2. [[日本数学竞赛当中覆盖圆盘的问题]] 如果我们可以把整个圆盘分为9个部分，而每个部分的直径(集合中任意两点之间距离的上确界)是小于2的，那么这10个点必然有两个点落在同一个部分当中。
3. [[前2n个正整数当中选n+1个必有两个数互素]]考虑到$\{1,...,2n\}$当中的元素可以分为n组两两相邻的元素:$$(2k-1,2k),1\leq k\leq n$$于是我们任意选n+1个元素，由[[鸽笼原理]]一定会存在两个元素在被分在同一组当中，从而导致互素。

### 2. 无穷鸽笼原理


> [!无穷鸽笼原理]
> 如果存在一个映射$f:A\to B$，并且在集合基数的意义下$|A|>|B|$并且$A$是无穷集合，那么在$B$当中一定存在一个值$y_0 \in B$使得其原像$f^{-1}(y_0)$是一个无穷集合。

因为有限个有限集合的并依旧是有限的，因此如果不存在某个元素的原像是无穷集合，那么就会和$A$是无穷集合的假设矛盾。

下面是一些应用：

* [[有限集合当中的序列必然存在一个常数子列]]这是第一点的典型应用。这里只需要把一个序列看成一个映射$f :\mathbb{N} \to E$,满足$f(n)=x_n$，那么结论是显然的。
* 证明Van der Waerden定理是Szemerédi定理的推论。下面先叙述一下两个定理:

> [!Van der Waerden 1927]
> 如果把$\mathbb{Z}^{+}$分为有限个子集的并，那么必然存在某一个子集其中包含任意长度的等差数列。

> [!Szemerédi 1975]
> 令$A \subset \mathbb{Z}^{+}$,如果此集合的上密度为正$$d^{*}(A):=\limsup_{N\to \infty}\frac{\#\{n\in A:n\leq N\}}{N}>0$$那么对于任意正整数$k$那么在集合$A$内至少存在一个长度为$k$的等差数列($a,a+r,...,a+(k-1)r \in A$)，也就是说存在任意长度的等差数列。

对于范德瓦尔登的命题，我们可以把这种对集合的划分理解为建立了一个映射$f:\mathbb{Z}^{+}\to B$,其中$B$是一个有限集合。那么由无穷鸽笼原理可知，必然存在一个元素$b\in B$，使得$|f^{-1}(b)|$是无限的。但是这还不够，因为如果我们要用Szemeredi定理来证明集合无穷集合$f^{-1}(b)$当中存在任何长度的等差数列，我们必须要说明其上密度是正的。于是我们提出第二个版本的无穷鸽笼原理：

> [!无穷鸽笼原理:密度版]
> 如果存在一个映射$f:\mathbb{Z}^{+}\to B$，并且集合$B$是有限集，那么在$B$当中一定存在一个值$y_0 \in B$使得其原像$f^{-1}(y_0)$的上密度为正。

如若不然，假设每一个原像的上密度都是0，那么由于上密度的三角不等式，即$d^{*}(A_1\cup A_2)\leq d^{*}(A_1)+d^{*}(A_2)$，我们可以知道有限个上密度为0的集合的并依旧是0上密度的。那么由于假设，$$1=d^{*}(\mathbb{Z}^{+})\leq \sum_{y\in B} d^{*}\left(f^{-1}(y_0)\right)=0$$
这是显然矛盾的，因此密度版本的无穷鸽笼原理是成立的。

---
上密度$d^{*}:P(\mathbb{Z}^{+})\to [0,1]$的基本性质:
1. $d^{*}(\varnothing)=0,d^{*}(\mathbb{Z}^{+})=1$
2. 单调性:$A\subseteq B \implies d^{*}(A)\leq d^{*}(B)$
3. 可加性:$d^{*}(A\cup B)\leq d^{*}(A)+d^{*}(B)$
4. $d^{*}(k A)=\frac{1}{k}d^{*}(A)$
5. 平移不变性：$d^{*}(A+h)=d^{*}(A)$

虽然以上性质看起来有点类似于外测度，但是这并非外测度，比如第三点的可加性，就不能扩展为可数可加性。比如[[natural density不存在的例子]]这里就给出了一个可数个有限集合，也就是upper density为0的集合的并是一个upper density为正的集合。这样自然就不能满足可数可加性。

---
那么由密度版本的无穷鸽笼原理，我们可以知道，一定存在$f^{-1}(b)$其上密度是正的，因此由Szemeredi定理我们知道此集合包含任意长度的等差数列。


* [[矩阵幂的秩会下降到一个固定的非负整数]]，这个问题当中使用了两次鸽笼原理，分情况讨论以及利用矩阵秩随着矩阵幂的增加不增的特性从而证明命题。
* [[满足特定条件的整系数多项式有整数解问题]] 解决问题的关键在于发现方程$xP(x)=yP(y)$的无穷多个**整数**解存在上界$x+y\leq M$,从而相当于把无穷个元素通过$x+y$映射到有限的集合当中，于是必然存在无穷个$x+y=c$。这样便做到了消元的操作，从而最后确认了最后多项式的整数零点。









---
tags:
  - math
  - 微积分
---

> [!问题1]
> 令$N(x,y):=\#\{(a,b)\in \mathbb{Z}^2:a^2+b^2\leq x^2+y^2\}$,求积分$$I=\int_{\mathbb{R}}\int_{\mathbb{R}}N(x,y)e^{-x^2-y^2}\,dx\,dy$$

或者看到在半径$r= \sqrt{x^2+y^2}$的圆盘上的整数格点的数目会让我们想起，高斯研究过的Circle Problem，即给出半径为$r$的闭圆盘内的整数格点的数目的估计。姑且不论这样做的难度，就算做到了也并不能解决此处的问题，因为即便是给出$$N(x,y)=\pi (x^2+y^2)+E(x,y)$$然后估计$E(x,y)$。无论$E(x,y)$多么精确，也不过是对$I$的近似，而不是表达$I$为更简单的形式。

因此由于此处的问题是找到$I$的更简单的Closed form的表达，因此问题应该是求积分类型的问题，而不是一个估计问题。

### 1. 思路1

> [!想法1]
> 整个积分中较为困难的部分就是$N(x,y)$这个函数。参考[[利用Dirichlet卷积法解决几个数论中求和问题]]中我们把一些复杂的数论函数按照其卷积展开，于是我们想到，是否可以把$N(x,y)$用某种积分或者求和的形式表达出来，然后交换次序。也就是说，整个思路按照[[和以及积分换序]]的想法来做。

至于说如何表示$N(x,y)$我们自然而言想到，用集合特征函数的积分。而因为这里的集合是$\mathbb{Z}^2$的子集，因此此处用的积分的测度是离散测度，因此事实上是一种和的形式。于是$$N(x,y):=\sum_{a,b\in \mathbb{Z}} 1_{a^2+b^2\leq x^2+y^2}(a,b)$$而此处交换次序，可以用Fubini-Tonelli定理来确定，因为这里无论是离散测度还是Lebesgue测度都是sigma-finite的，并且被积分对象都是可测的。(参考[[Fubini-Tonelli定理的例子与反例]])

于是$$\begin{aligned}I&:=\int_{\mathbb{R}}\int_{\mathbb{R}}N(x,y)e^{-x^2-y^2}\,dx\,dy\\&= \int_{\mathbb{R}}\int_{\mathbb{R}} \sum_{a,b\in \mathbb{Z}} 1_{a^2+b^2\leq x^2+y^2}(a,b)e^{-x^2-y^2}\,dx\,dy \\&=\sum_{a,b\in \mathbb{Z}}  \int_{\mathbb{R}}\int_{\mathbb{R}} 1_{a^2+b^2\leq x^2+y^2}(a,b)e^{-x^2-y^2}\,dx\,dy \\&= \sum_{a,b\in \mathbb{Z}}  \int_{x^2+y^2\geq a^2+b^2}e^{-x^2-y^2}\,dx\,dy \\&= \sum_{a,b\in \mathbb{Z}}  \int_{r\geq \sqrt{a^2+b^2}}\int_{0}^{2\pi}re^{-r^2}\,dr\,d\theta\\ &= \pi\sum_{a,b\in \mathbb{Z}} e^{-(a^2+b^2)}\end{aligned}$$
* 最后的积分的极坐标变换是因为被积分的函数中带有$x^2+y^2$的结构，这样有助于把双变量的积分转换为单变量的积分。

算到最后就到此为止了，因为结果是与Jacobi's Theta函数有关的结果，假设我们定义$$\vartheta(t):=\sum_{n\in\mathbb{Z}} e^{-\pi n^2t},t>0$$的话，最后的结果就是$$I=\pi\vartheta(\frac{1}{\pi}) $$
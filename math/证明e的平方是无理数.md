---
tags:
  - math
  - 数论
---

> [!命题]
> $e$是自然常数,那么$e^2$也是无理数。

### 1. 方法1

在[[证明e是无理数]]当中我们利用[[一种证明某个数为无理数的办法]]中命题1的思路，我们发现利用$e^x$的幂级数的表达就能轻松找到很好地逼近$e$的有理序列，那么这种经验在证明$e^2$上也能继续奏效吗？

首先我们意识到$$0<\left|e^2-\sum_{k=0}^{n}\frac{2^k}{k!}\right|=O\left(\frac{2^{n+1}}{(n+1)!}\right)$$不过现在我们就不能像证明$e$是无理数那样简单地把部分和的没有化简之前的分母$n!$作为$q_n$了，因为这样我们没有办法保证最后的$|q_n e^2-p_n|=o(1)$。不过我们还是倾向于猜测，可能还是可以从部分和当中得到我们需要的$q_n,p_n$从而证明$e^2$是无理数。当然这种猜测并不是无缘无故的，我们可以先计算一下前200项的部分和的精确的即约的$q_n,p_n$看看这种逼近是不是比较好的。

```wolfram
(*因为问题当中精度要求比较高，因此提前提高默认精度*)
$MaxExtraPrecision = 400;
(*Step 1:生成部分和形成的有理数*)
fractions = 
  RecurrenceTable[{x[k + 1] == x[k] + 2^(k + 1)/(k + 1)!, x[0] == 1}, 
   x, {k, 0, 200}];

(*Step 2:得到每一个有理逼近的分子，分母*)
numerators = Numerator /@ fractions;
denominators = Denominator /@ fractions;

(*Step 3:计算|q_n*e^2-p_n|的结果*)
AbsValues = Abs[denominators*E^2 - numerators];

(*step4:画图*)
ListPlot[AbsValues]
```
![[E的平方是否能被很好地有理逼近.png]]

至少从数据上，这个部分和如果我们能把分子分母表达为即约的分数，那么很有可能$|q_n e^2-p_n|=o(1)$从而使得$e^2$是无理数。但是想要搞清楚$\sum_{k=0}^{n}\frac{2^k}{k!}$的即约分数的表达是困难的，不过此处未必就需要搞清楚其分母那么精确的信息，但凡我们能实现下面这件事，问题也能解决：

> [!想法1]
> 我需要构造一个整数的$q_n$，使得$q_n\sum_{k=0}^{n}\frac{2^k}{k!}$是整数，于是就可以把它设置为$p_n$，并且同时要保证$q_n\frac{2^{n+1}}{(n+1)!}=o(1)$，这样便能保证$$0<|q_n e^2-p_n|=o(1)$$从而证明$e$为无理数。

#### 1.1 $q_n = \frac{n!}{2^n}$可行吗?

乍一看似乎还可以，至少可以满足保证$q_n\frac{2^{n+1}}{(n+1)!}=o(1)$。但关键是，最基础的条件$q_n$真的总是整数吗？

> [!问题1]
> $\frac{n!}{2^n}$总是整数吗？

为了回答这个问题，我们需要搞清楚$n!$当中有多少个$2$这样的素因子。参考[[从二项式系数到Kummer定理]]中的2.2叙述的Legendre公式的变形版本我们知道:
> [!Legendre公式 版本2]
> 令正整数$n$的p-adic展开的所有系数和为$S_p(n)$那么$n!$的p-adic valuation可以表示为$$\nu_p(n!)=\frac{n-S_p(n)}{p-1}$$

这个式子里面$\nu_2(n!)$就表示$n!$当中含有多少个素因子2，而问题1要问的是，是否$\nu_2(n!)\geq n$?

首先我们很容易知道，自然数的二进制表示的和$$1\leq S_2(n)\leq \lfloor \log_2(n)\rfloor+1$$因为自然数的二进制表达里面最多有$\log_2(n)$位数，就算每一位都是1那么系数和也就最多是$\log_2(n)$，而正整数二进制表达当中位数之和最小就是1（$n=2^m$的时候）。既然如此$$n-1\geq \nu_2(n!)\geq n-\lfloor \log_2(n)\rfloor-1$$
那么这也就说明问题1的答案就是$\frac{n!}{2^n}$对于正整数$n$都不是整数。
#### 2. 如果考虑子列呢？

那么这是否说明想法1是失败的呢？

未必，因为经过上面的分析，$n=2^m$的时候因为$\nu_2(n!)=n-1$此时$\frac{n!}{2^{n-1}}$总是一个整数。所以为何我们不能尝试一个子列呢？

> [!想法2]
> 假设$S_n:=\sum_{k=0}^{n}\frac{2^k}{k!},q_n=\frac{n!}{2^{n-1}}$,我们干嘛不能尝试$S_{2^m}$呢？此时假设$Q_m = q_{2^m},P_m=Q_mS_{2^m}$，于是$$0<|Q_me^2-P_m|=O\left(\frac{1}{2^m+1}\right)$$所以如果$P_m$能保证始终是整数，整个证明就能成立。

所以下面着手检验这想法2。

$$P_m=\sum_{k=0}^{n}\frac{2^kn!}{2^{n-1}k!},n=2^m$$通过一些观察可以发现(其实就是用Mathematica算大量例子)，
似乎$P_m$的每一项都是整数。如果我们可以证明这一点，那么我们就可以肯定$P_m$一定是整数。

> [!命题2]
> $$\nu_2\left(\frac{n!}{k!}\right)\geq n-1-k$$当$n=2^m$的时候。

因为$\nu_2(n!)=n-1$当$n=2^m$的时候，于是由p-adic valuation的性质(参考[[从二项式系数到Kummer定理]]中1的说明)$$\begin{aligned}\nu_2\left(\frac{n!}{k!}\right)&=\nu_2(n!)-\nu_2(k!)\\&=(n-1)-(k-S_2(k))\\&=n-1-k+S_2(k)\end{aligned}$$于是命题2成立。

那么现在我们也就证明了$P_m$是整数，于是$$0<|Q_me^2-P_m|=O\left(\frac{1}{2^m+1}\right)$$成立，并且其中$Q_m,P_m$皆为整数，故想法2是可行的，因此$e^2$是一个无理数。
